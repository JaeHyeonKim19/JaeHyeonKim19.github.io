<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.a430335728e3cf41addc.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{position:relative;margin:.5em 0;overflow:visible;padding:0}pre[class*=language-]>code{position:relative;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-size:3em 3em;background-origin:content-box;background-attachment:local}code[class*=language]{max-height:inherit;height:inherit;padding:0 1em;display:block;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{position:relative;padding:.2em;border-radius:.3em;color:#c92c2c;border:1px solid rgba(0,0,0,.1);display:inline;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{content:"";z-index:-2;display:block;position:absolute;bottom:.75em;left:.18em;width:40%;height:20%;max-height:13em;box-shadow:0 13px 8px #979797;transform:rotate(-2deg)}:not(pre)>code[class*=language-]:after,pre[class*=language-]:after{right:.75em;left:auto;transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}.token.cr:before,.token.lf:before,.token.tab:not(:empty):before{color:#e0d7d1}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-top:0;padding-bottom:0;padding-left:0}pre[data-line] code{position:relative;padding-left:4em}pre .line-highlight{margin-top:0}html{font-family:Apple SD Gothic Neo,arial,sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em Apple SD Gothic Neo,arial,sans-serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:Apple SD Gothic Neo,arial,sans-serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style><meta name="generator" content="Gatsby 2.23.1"/><title data-react-helmet="true"></title><link rel="icon" href="/favicon-32x32.png?v=db33395577ec4a434ab68177782919fb"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#000000"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=db33395577ec4a434ab68177782919fb"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=db33395577ec4a434ab68177782919fb"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/component---src-templates-post-template-jsx-21e5cdc1750e46a29022.js"/><link as="script" rel="preload" href="/app-d8b803c152e4e53a0b70.js"/><link as="script" rel="preload" href="/framework-d54fcf3f0204b459cf2d.js"/><link as="script" rel="preload" href="/styles-9b6f388623a2ec93d35f.js"/><link as="script" rel="preload" href="/webpack-runtime-92b8d634de3575c5751f.js"/><link as="fetch" rel="preload" href="/page-data/computerArchitecture/5-large-and-fast-exploiting-memory-hierarchy/2020-10-04 09:00:00 +0900/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header style="margin-bottom:1.45rem"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem"><h1 style="margin:0"><a style="color:black;text-decoration:none" href="/">JaeHyeonKim19</a></h1></div></header><div style="margin:0 auto;max-width:960px;padding:0 1.0875rem 1.45rem"><main><h2>[컴퓨터구조론] 5. Large and Fast: Exploiting Memory Hierachy</h2><h4>2020-10-04</h4><hr/><div><blockquote>
<p>본 글은 영남대학교 최규상 교수님의 <a href="http://www.kocw.net/home/cview.do?cid=184062fa9a833237">컴퓨터 구조</a> 강의를 듣고 작성된 글입니다.</p>
</blockquote>
<h3>5.1 Introduction</h3>
<ul>
<li>
<p>Principle of Locality</p>
<ul>
<li>Programs access a small proportion of their address space at any time</li>
<li>
<p>Temporal locality</p>
<ul>
<li>Items accessed recently are likely to be accessed again soon</li>
<li>e.g., instructions in a loop, induction variables</li>
</ul>
</li>
<li>
<p>Spatial locality</p>
<ul>
<li>Items near those accessed recently are likely to be accessed soon</li>
<li>e.g., sequential instruction access, array data</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Taking Advantage of Locality</p>
<ul>
<li>Memory hierarchy</li>
<li>Store everything on disk</li>
<li>
<p>Copy recently accessed (and nearby) items from disk to smaller DRAM memory</p>
<ul>
<li>Main memory</li>
</ul>
</li>
<li>
<p>Copy more recently accessed (and nearby) items from DRAM to smaller SRAM memory</p>
<ul>
<li>Cache memory attached to CPU</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Memory Hierarchy Levels
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4b95ae0a78dcb34f8b022737de7cb18b/9f82e/memory-hierarchy-levels.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 118.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAABYlAAAWJQFJUiTwAAACbklEQVQ4y6VU26rTUBDt7wv+guCDID4qwnlQ5KAgltLSm23TtIlp03vT+y29LbPGM2G35LTCGVgk2XvPysysmZ06n8+g8RmGIfb7PY7Ho3zzaeJwOMh+GMH0My2lCyQbjUY4nU4Yj8fodDpYLBaYTCaYTqeYzWZYr9dCyLXtdhsTmqQx4W63EydaEASoVCrIZrPIZDJIp9PI5XJYrVayv1wuhfwmIf/c6/UkGkKja7fb8gNdJwaDgWR0M2Wa1kjq9FTPRqMh6Zl7rGcS2QWhuWke0zSv7a4omjbOx6do/6lq2zY2m00cNcH1uxGG4R6LWYAvPyt4/fYrep02vFYLvu/HKiuGw+FFDRNF2W532G3W+G37+PD5B5ymjVarnZguBWPUN1Nm27AdVss5/JaLet2W6JKM50xCExeEQdTQ/f4AVr0utfvjeaIw90hA8J2Nr4QcBBMxIT/m87nUiE+mxfdSqSQ1ZM2UWKckyVJmuElGcpLk83kUCgUpgxdFblkWarUayuUyisVi/J3CHWN6jK7ZbIoDZ5wgMdccx5Hmd11XkOJMMiVGYoJjRzACrdk1mLq2T5wynfQW0TqxcRlBtVqVqHhRkLjf78ueCkVwTa87EYXF58u18Sqj0vVIcYI1YibXxoDUX9qG6ZmjpOLwRiEhUZOCR4SR8/U53kT/Rcjx0gh9rwnXaSB4CeEgImRknJpXbx7w/tNjNJqrFxBGKVerNbjRTL/7+B0P337JWOoQPEv4nCgkFIUjpT3HRsO2RIC7olA5tg1bgO2gvdXtdqVhCcuqC1hXtpeeow9/fEFIZ21SE0mNnHTOnGsS/gUgJTrieNNNnQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="memory-hierachy-levels"
        title="memory-hierachy-levels"
        src="/static/4b95ae0a78dcb34f8b022737de7cb18b/5a190/memory-hierarchy-levels.png"
        srcset="/static/4b95ae0a78dcb34f8b022737de7cb18b/772e8/memory-hierarchy-levels.png 200w,
/static/4b95ae0a78dcb34f8b022737de7cb18b/e17e5/memory-hierarchy-levels.png 400w,
/static/4b95ae0a78dcb34f8b022737de7cb18b/5a190/memory-hierarchy-levels.png 800w,
/static/4b95ae0a78dcb34f8b022737de7cb18b/9f82e/memory-hierarchy-levels.png 820w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<ul>
<li>
<p>Block (aka line): unit of copying</p>
<ul>
<li>May be multiple words</li>
</ul>
</li>
<li>
<p>If accessed data is present in upper level</p>
<ul>
<li>
<p>Hit: access satisfied by upper level</p>
<ul>
<li>Hit ratio: hits/accesses</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If accessed data is absent</p>
<ul>
<li>
<p>Miss: block copied from lower level</p>
<ul>
<li>Time taken: miss penalty</li>
<li>Miss ratio: misses/accesses = 1 - hit ratio</li>
</ul>
</li>
<li>Then accessed data supplied from upper level</li>
</ul>
</li>
</ul>
</li>
<li>Characteristics of the Memory Hierarchy
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7914ddf74035f64be718948e90e8ab9d/e2cbf/characteristics-of-the-memory-hierarchy.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACWElEQVQoz12TWXObQBCE9f9/Tx78knKSKjuxrMNYJ0IgzCGBxCEEiJsvq9NOtmprF3a2t2e6p8N1tG3L//vT2tYNFDXEOU2Q0DbN/bzJSqpDRtOIuGt853zpNpsrwO1CkhOPdZSnAcvhmHD+Qbs93B8unZDsfUXl+Ce4878OX0Zb1eRR8vld1hSqw8F2UaUppqwR6Rb5dnc+z3SX9befbB6fCTcbgjC8MCyKglzMeB+RrD3qw5GmrERKBa1IN9LXhCOVMojJjS3FLjoD5l7E7KmP1B0wlUasdJ1OXdcMh0O63S66opLqDqXlU0cCNM3JwxhnOGf58IS10DiYGwrboS4qCpHNoicx6b8xG0ioU5lOIwCXqspMUQiD8Bx0S/foRxw/XFxJQZvIRHHMwd1xHC4pBctsHzN5FewmE+bjKbq2olMJQE1esHrt4cwV8jS7CNI2xNuAaKQJhjLq4yub3yOM7ojmWuNTvWUBpGoanu8RJ4lgKIQ4Tua0xprK25Nn+Tk4SVNKd8/m15DZc4/Bww+mj3/YCbbxQdSwqUlcj/7LC6ZpEgpBoigSooha1IL6SfQyyc6vFlXJMYpJVhsyc0u0tFBf3rAlGUOa48+WJLJKvNCJLQuq6u6Mf2yTmx7BTKdohZHTgvX3HspghCLAtO47i1cJuz+lciMR0xBqNlV6yejs4buxr05vhLKhUHEXBoR+gL922DlClA8Ld77CmWlsRcqBYrAbq3gr69IIt666AX5tt1TU7iS/qRvYls3asLBVHVtYxpwssCYK5lTBGC/wA/8T7Lr+BcwpifUubdMYAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="characteristics-of-the-memroy-hierarchy"
        title="characteristics-of-the-memroy-hierarchy"
        src="/static/7914ddf74035f64be718948e90e8ab9d/5a190/characteristics-of-the-memory-hierarchy.png"
        srcset="/static/7914ddf74035f64be718948e90e8ab9d/772e8/characteristics-of-the-memory-hierarchy.png 200w,
/static/7914ddf74035f64be718948e90e8ab9d/e17e5/characteristics-of-the-memory-hierarchy.png 400w,
/static/7914ddf74035f64be718948e90e8ab9d/5a190/characteristics-of-the-memory-hierarchy.png 800w,
/static/7914ddf74035f64be718948e90e8ab9d/c1b63/characteristics-of-the-memory-hierarchy.png 1200w,
/static/7914ddf74035f64be718948e90e8ab9d/29007/characteristics-of-the-memory-hierarchy.png 1600w,
/static/7914ddf74035f64be718948e90e8ab9d/e2cbf/characteristics-of-the-memory-hierarchy.png 2138w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>DRAM Technology</p>
<ul>
<li>
<p>Data stored as a charge in a capacitor</p>
<ul>
<li>Single transistor used to access the charge</li>
<li>
<p>Must periodically be refreshed</p>
<ul>
<li>Read contents and write back</li>
<li>Performed on a DRAM "row"
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/36d2522acbf835156832bd909786ef60/541fe/dram-technology.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+klEQVQoz22R2aqGMAyEff+HVHDFve67+flyiPTiCIPpNJ1MkkC877ouWdf1O7/vq9i2Tfl932WaJun7XmN4cBzH9ybgIooiqetaHzVNI13XfQn3fesdPP+iKCRJEo3LspSqqiTPcxmG4U/QOSdhGOoFwEGWZTKOoyac5ylt2+qZXDCNkxZdlkVNAHg6DOZ5VvvYpiIPqZimqcRxrOIAh+RS0AQYh//RTeATJGKdGQGKwCFo7gHOEHye55szYipohC0FIVpkRswK17glxiFiLMJm5i/wEzTC/ojato13g9NCLMUK2gwpQKwz9OfwX+xzOEAMEdq1Ng3k/gAgzGtOmfasIgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="dram-technology"
        title="dram-technology"
        src="/static/36d2522acbf835156832bd909786ef60/5a190/dram-technology.png"
        srcset="/static/36d2522acbf835156832bd909786ef60/772e8/dram-technology.png 200w,
/static/36d2522acbf835156832bd909786ef60/e17e5/dram-technology.png 400w,
/static/36d2522acbf835156832bd909786ef60/5a190/dram-technology.png 800w,
/static/36d2522acbf835156832bd909786ef60/c1b63/dram-technology.png 1200w,
/static/36d2522acbf835156832bd909786ef60/29007/dram-technology.png 1600w,
/static/36d2522acbf835156832bd909786ef60/541fe/dram-technology.png 1654w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Advanced DRAM Organization</p>
<ul>
<li>
<p>Bits in a DRAM are organized as a rectangular array</p>
<ul>
<li>DRAM accesses an entire row</li>
<li>Burst mode: supply successive words from a row with reduced latency</li>
</ul>
</li>
<li>
<p>Double data rate (DDR) DRAM</p>
<ul>
<li>Transfer on rising and falling clock edges</li>
</ul>
</li>
<li>
<p>Quad data rate (QDR) DRAM</p>
<ul>
<li>Separate DDR inputs and outputs</li>
</ul>
</li>
</ul>
</li>
<li>
<p>DRAM Generations</p>
<ul>
<li>시간이 지남에따라 가격은 낮아지고 용량은 증가하였음</li>
</ul>
</li>
<li>
<p>DRAM Performance Factors</p>
<ul>
<li>
<p>Row buffer</p>
<ul>
<li>Allows several words to be read and refreshed in parallel</li>
</ul>
</li>
<li>
<p>Synchronous DRAM</p>
<ul>
<li>Allows for consecutive accesses in bursts without needing to send each address</li>
<li>Improves bandwidth</li>
</ul>
</li>
<li>
<p>DRAM banking</p>
<ul>
<li>Allows simultaneous access to multiple DRAMs</li>
<li>Improves bandwidth</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Main Memory Supporting Caches</p>
<ul>
<li>
<p>Use DRAMs for main memory</p>
<ul>
<li>Fixed width (e.g., 1 word)</li>
<li>
<p>Connected by fixed-width clocked bus</p>
<ul>
<li>Bus clock is typically slower than CPU clock</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Example cache block read</p>
<ul>
<li>1 bus cycle for address transfer</li>
<li>15 bus cycles per DRAM access</li>
<li>1 bus cycle per data transfer</li>
</ul>
</li>
<li>
<p>For 4-word block, 1-word-wide DRAM</p>
<ul>
<li>Miss penalty = 1 + 4 * 15 + 4 * 1 = 65 bus cycles</li>
<li>Bandwidth = 16 bytes / 65 cycles = 0.25 B/cycle</li>
</ul>
</li>
</ul>
</li>
<li>Increasing Memory Bandwidth
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/775a307bb04a55bfbe10f197b56b8985/aea0a/increasing-memory-bandwidth.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7ElEQVQ4y32TC3OiMBSF/f+/ame6bdeVHWrrA0FRQevyUJA3Ap7NiZXK2mlmMrkk8cu59x57dV2jKApw5TifzyjLUu4xvu5d49PpdHd2O3ppmsK2bSRJ0m76vg/XddvvW+B+v8d2u0VVVV8DqSYMQ/kqB9flconVaoU8z++AFBBFUSej21UCqegKpNL1eg3LshDH8R0wjhMcDofvgAWOxxBcP2uUi7WUcdM0nZR4liSxADSdkrQpR3GGt5GFILiocdwj1Nc1Xt4svP8N5V5V1Xh5NaEOTQz+6BgoMxn3FR3+Pupk0QvDTBzY8PzLwfsuwGPfwPNggZXl8yoo5rdi4OFxjJ9Pk8t85qrB9Y7/A1M89U1RxwswzzPRYUd8e9jtdrKrbA67HgSBjFnbLMs6pWiBQZDgx4MG7+OlpqmEWg+6rsMwDGiahvl8LjtPKGvKhhDMya5fGyRryJQVddPWQkJFjQkajUYYDofSd1S7WCzgOA42mw0mk4l8SFEUzGYz+RgdIxRm+DWwhBXSSwPqUgKokFBOqptOpxJCKG12VUYIY5aDZu9lWSEuL4X37A/fnZGIC+PxWMJUVZVwKqPZTdOUaulFxlRLpYTKlAmgt+I4ao1Mm/DHrOFcKGJjaHTuEcy/KlUzJpQp85zjH/oi3OejkdprAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="increasing-memory-bandwidth"
        title="increasing-memory-bandwidth"
        src="/static/775a307bb04a55bfbe10f197b56b8985/5a190/increasing-memory-bandwidth.png"
        srcset="/static/775a307bb04a55bfbe10f197b56b8985/772e8/increasing-memory-bandwidth.png 200w,
/static/775a307bb04a55bfbe10f197b56b8985/e17e5/increasing-memory-bandwidth.png 400w,
/static/775a307bb04a55bfbe10f197b56b8985/5a190/increasing-memory-bandwidth.png 800w,
/static/775a307bb04a55bfbe10f197b56b8985/c1b63/increasing-memory-bandwidth.png 1200w,
/static/775a307bb04a55bfbe10f197b56b8985/29007/increasing-memory-bandwidth.png 1600w,
/static/775a307bb04a55bfbe10f197b56b8985/aea0a/increasing-memory-bandwidth.png 2018w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
<h3>5.2 Memory Technologies</h3>
<ul>
<li>Review: Major Components of a Comupter
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4420295ef531acc97791138a9e6e05a5/07a9c/review-major-components-of-a-computer.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABwUlEQVQoz5VSabPBQBD0/38PT5VSFOW+b0lQeES5bxKCftuDyAdf3lZ1JTs709M9u77z+YzL5QLbtl1w/x9YliV1XL7j8Yj7/Q7vejweEnMcx8X1esXtdhPw/A3mkVDTtCchFW63W/R6PZimieFwiNlsJvv9fi9k7M5CxsfjMdbrNRaLBZbLJU6nk+QahvFRSPT7fbRaLdRqNYxGI1SrVRwOh6filwPGWcw8nlcqFSEsl8vodDpPQhZRMq14LefzeRxVsuxfcXMycZVwUTVdfCVk52KxiFwuJ4c/wSBsdXbtGrDVGLBQdpULTdfFDUkoYjAYIBqNSswl5Ixoh3abzabYCYVCsJRCp9+DZeh4/A4x6nZhqGYDVczmE6W4VCohFot9CDk/zoGHHPp8PpfBx+Nx8MLE2sviWOXoSiEvjwS8wEajgWw2Kw5dhQQ7FQoF+dbrdfj9frlh75pOp9DVDEmUTqfFLokikchHIedHhbRL6YlEQr7hcBibzQar1UqeyG63Q7vdFrAp55ZMJhEIBKTGJaR8Pkp2fCOVSskc2YT/mUzGBdUz9gbz+Xzch81HzblRjRdURnyLe/espwM65foDY+Z43Z+ATTAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="review-major-components-of-a-computer"
        title="review-major-components-of-a-computer"
        src="/static/4420295ef531acc97791138a9e6e05a5/5a190/review-major-components-of-a-computer.png"
        srcset="/static/4420295ef531acc97791138a9e6e05a5/772e8/review-major-components-of-a-computer.png 200w,
/static/4420295ef531acc97791138a9e6e05a5/e17e5/review-major-components-of-a-computer.png 400w,
/static/4420295ef531acc97791138a9e6e05a5/5a190/review-major-components-of-a-computer.png 800w,
/static/4420295ef531acc97791138a9e6e05a5/c1b63/review-major-components-of-a-computer.png 1200w,
/static/4420295ef531acc97791138a9e6e05a5/07a9c/review-major-components-of-a-computer.png 1440w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>Memory Technology</p>
<ul>
<li>
<p>Static RAM (SRAM)</p>
<ul>
<li>0.5ns ~ 2.5ns, $2000 ~ $5000 per GB</li>
</ul>
</li>
<li>
<p>Dynamic RAM (DRAM)</p>
<ul>
<li>50ns ~ 70ns, $20 ~ $75 per GB</li>
</ul>
</li>
<li>
<p>Magnetic disk (HD)</p>
<ul>
<li>5ms ~ 20ms, $0.20 ~ $2 per GB</li>
</ul>
</li>
<li>
<p>Ideal memory</p>
<ul>
<li>Access time of SRAM</li>
<li>Capacity and cost/GB of disk</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Processor-Memory Performance Gap</p>
<ul>
<li>프로세서와 메모리의 성능 차이는 시간이 지날수록 양극화되어 왔다.</li>
</ul>
</li>
<li>
<p>The "Memory Wall"</p>
<ul>
<li>Processor vs DRAM speed disparity continues to grow
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c557e2920c0b74cad40f2ead259d38a2/d3d45/the-memory-wall.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACKUlEQVQ4y22T63LaMBCF8/4v1fxiYGghQEJhuJWbwQYZ46tsST49EnFwpt0ZDbawvj27e/RS1zVsSClxPB5RFAWMMdBa/3cppfi/5gmDutYoS/ttjbLSjvPicEWOaxCg0+kg8H0Ht+D2sntlKVFVEllW4HLJsNulFJFCxBp/AvUAOt7bL0osEKcp7vc7GtXtsFt5bgjSCAKNKDJUS51K4paq70A5foNKEozf33Giwk+EW1IaCKFwOmmIG1je90RVSbWxwkHoJzAf/HRlS6aMLgEqqXBPAd9XVKOQ5QTnOYrowncfcRyzDZK9rKGpcH9VWPktYDGbMlWF8/WC7WQOb3zA7RBC6WfpWRhCzFf48fqKyWSCkO9aG1fyNqiwCVpA+fsDJs/cxj3J3PQQ36DOHhTV2EgKg80uQa/bxXA4xGg0cm5QHFLEHnphW+FkhJolWT2huLpSXBetVUJBsA8TsYGm+mdYFYcpEkWF7aEM+qioRNxuiDllm9mOtSnYgtV+S/AJFYem7hEMbQQmVvSkSDR218aHPCg/xtD02lWErjcO2PLLF5j7dVnCJDE0h6dYTbldwRcF9qIF5Jf0WE6PXZDQPk08boV5GvEzNJ/dcdvDNEapKErVLaBtOkG9Xg+LxQLL5RLn85mDr3grMqzXa3ie537t9SztreGy1Wy2W3cZHjnrRuEDOp/PMZ1O0eUk7eFGpbXJbDZDv9933zQhhMBgMMB6s/kC/gX1/OlyCt8+zwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="the-memory-wall"
        title="the-memory-wall"
        src="/static/c557e2920c0b74cad40f2ead259d38a2/5a190/the-memory-wall.png"
        srcset="/static/c557e2920c0b74cad40f2ead259d38a2/772e8/the-memory-wall.png 200w,
/static/c557e2920c0b74cad40f2ead259d38a2/e17e5/the-memory-wall.png 400w,
/static/c557e2920c0b74cad40f2ead259d38a2/5a190/the-memory-wall.png 800w,
/static/c557e2920c0b74cad40f2ead259d38a2/c1b63/the-memory-wall.png 1200w,
/static/c557e2920c0b74cad40f2ead259d38a2/29007/the-memory-wall.png 1600w,
/static/c557e2920c0b74cad40f2ead259d38a2/d3d45/the-memory-wall.png 1614w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>Good memory hierachy (cache) design is increasingly important to overall performance</li>
</ul>
</li>
</ul>
<h3>5.3 The Basics of Caches</h3>
<ul>
<li>
<p>Cache Memory</p>
<ul>
<li>
<p>Cache memory</p>
<ul>
<li>The level of the memory hierarchy closest to the CPU</li>
</ul>
</li>
<li>Given accesses X1, ..., Xn-1, Xn</li>
<li>How do we know if the data is present?</li>
<li>Where do we look?
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7e111b7d53cd97b1417e4de37ae447f5/76aed/cache-memory.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 72.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABZklEQVQ4y42T63KCUAyEff/n8w92LJY7ioLIXSH1y0wYW6mVmczJSZZNsoGV3J+maaTrOrler1LXtez3e/WHYdA4sdvtJmVZahw7HA5yuVzmu/krCHkB0r7vpaoqBeNDRtwIi6LQGLksy7SA4azYEyGJ0+m0SHg+n+c4hMS523tPhIx4PB4lSZIZ/JsQDPc4jiXP87njRUKSppvZXx1ytm37mtAS6LhEiIbWNf7/hEOvI7NlA5N73DITkEMWNgsZsZdbRp+lpVCMPPcoCnUxVVUrGXr+IMQgoDr+Y4f4EK3Xa+2egh/bnXx5vvppmspms9HiTx1yPmpoOcxxHCVM7+NuP3fi+4H6ELquq/jV0p+CPvan0B02jqMuAiz3OIr0e7WJ0BdZlJAgegBACwy9uNs2p2nSz8ZimPnEIeVRQkT1PE/1iO6VOX3flzAM9TeEnOqMGwSBjggODCcYyJWQyu887+DAfANU8Tmm8uHO4gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="cache-memory"
        title="cache-memory"
        src="/static/7e111b7d53cd97b1417e4de37ae447f5/76aed/cache-memory.png"
        srcset="/static/7e111b7d53cd97b1417e4de37ae447f5/772e8/cache-memory.png 200w,
/static/7e111b7d53cd97b1417e4de37ae447f5/e17e5/cache-memory.png 400w,
/static/7e111b7d53cd97b1417e4de37ae447f5/76aed/cache-memory.png 546w"
        sizes="(max-width: 546px) 100vw, 546px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>Caching: A Simple First Example
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c60726dbf59e9be6aa980db141c6d589/33c9c/caching-a-simple-first-example.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 68.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAC60lEQVQ4y3WTW4+bVhSF/f9/QKU+9KlPrVQlVaVGShopk4yicTKNZ2JjGwYMGN8O94sBG8Z83eAkbz3Sggc2a6+19zoj+tMJTi1d1/Gclpy9gDYuuDQtl7MgOdJGOZ1KicKUl7dj/ry944W8zb0aKC6Xbvh/9CwPlWb4dwsa16d+tMn/GlNpLo2QtEFGMjFohKiwDnhv/sVYGHhBiCtkcZbTNA3fzyg/Vvz++j3vbj7xLCpra0+5cGnLeig45gWJ7UFWEI0t7J9fUdwvsG0bbTYVzLi/vycIgith7aeoj4/sdBO/rMg2KbHyiTcHChURxhEHteVU5aipg/XrW8LxFGe9RtM0DMMY4Hme2L4wEsec3R2pt+PwVSd+/0BbncjXB8y7CUEUEqcpp66hODccJvpQmxWiOIoG+L7P+Xy+KmyzinpqkWom+98+sP/pb+rPS46vxkx/+QM/iSmyFJ7PYj1CfzEmdjz+74wudcPJ3JItHRLDI/xqyBLmBOMHJm9v2KkDfij285DA2bF590joesSyFCXKovCqUilFkiS95W6IBc/djy5tVkqUuuEHy7LI8pyLZOuYn9h8eCC01yRxQhTHA1ks734pZVky6gnKuiaROSVRXxAL9+VKLDl0HAe123IR0sSUub68Q8kCVwJTmpmmOWA+n18VDoQy4PhbJ18snuuK7tIOpGEoedutOTbF0FDdaySylJ5s8uULM4mNrutDXb+YgVCFGdpCHz7YG5+luWYfpANhVVVDcX+d8rDEkRQow0JfLgdVy8WCp6cn2vYqYNQX+mmL7iZCFmKpBsdvMLyMXEI9qDzsOGei3pFmr2WG+or5YslUcjgTLIW8V/zDstrvmGtzCegTs+kUb+2yltnVdXmdpWTwdDpSrTZUHzVKfc3WdfEMEyUb30io7dVKRlUz2ord1VaxkOu1tDfMLY9tVKBko97dnPifz2xu5Wb0uHnA/aSxmZkcnlwO9ha13hH2dzqIyMT2f33zEO24eYvPAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="caching-a-simple-first-example"
        title="caching-a-simple-first-example"
        src="/static/c60726dbf59e9be6aa980db141c6d589/5a190/caching-a-simple-first-example.png"
        srcset="/static/c60726dbf59e9be6aa980db141c6d589/772e8/caching-a-simple-first-example.png 200w,
/static/c60726dbf59e9be6aa980db141c6d589/e17e5/caching-a-simple-first-example.png 400w,
/static/c60726dbf59e9be6aa980db141c6d589/5a190/caching-a-simple-first-example.png 800w,
/static/c60726dbf59e9be6aa980db141c6d589/33c9c/caching-a-simple-first-example.png 1133w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>Direct Mapped Cache</p>
<ul>
<li>Location determined by address</li>
<li>
<p>Direct mapped: only one choice</p>
<ul>
<li>(Block address) modulo (#Blocks in cache)</li>
</ul>
</li>
<li>
<h1>Block is a power of 2</h1>
</li>
<li>Use low-order address bits
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 703px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2537f1b00624247a7162ad22755fa7cd/242e2/direct-mapped-cache.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACKklEQVQ4y4WS7U/TUBSH+df1Ex+N8SPGRI1ESdTEREENonEgwQFb17F2lJWOrVu7dWv30m5d+3jbsVeInOTmvp37nN85526QWMzyNF3Hy7vV/d27xXojocS3tHg+4vnDKIrwPA/TNAnH45W7Zdjs7X+BCaxcVlGUC/KFIpJcwveHDwBnsEUCKyldXmq07Tp7x1fsfM+LkzGTaOqzDp2mzLLC+E6NihclnFaD3T8ab7+ei5NwDlxXOlcYs+owW49FzU7+ZtE1he0vJzx/fwgTnyhmTWG8BowXKUS3Tr7vEwQBlYpO1dDJSpccnSr4wz5+MFoJHi2VYGP9CyQ2EqDkfDgcMgnHhGKk83hEIAIRR4xGI+6zVGEYhrTbjog+QFKrtJwOtm2Lr1Kn2nDQ9BotsU++j6bfoFbquN0OZsOk3x9Q0ptp8FRhAgxECrm8hNux2XyZQS4bFOUCrWadN7t5PuyfYzVq1KoGv8+ueLr9C8duiDd5aqbF460Dep7LZBJNgUnxs9kz/L7Lk+0MZb2OqpTotC12vknsZWTR6SbVa50T2WDr4zFep0Uul6PtuGy+2GfQ7wngZKYwSBUGA4/NVxlU3aSsKnQE5PXnMz79LOA6tlB4TeZc59m7I7xuC0kqYLe7PNr6ged2FwoTYEGWRV26HGaLNCybK00TdbQoKBWKaoUbka5hXGPUmqLjauqrqmJ2PQ5PL0Qt+9Om3Nfldev1PJqWlab0kP0D2f8qNbPHYAIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="direct-mapped-cache"
        title="direct-mapped-cache"
        src="/static/2537f1b00624247a7162ad22755fa7cd/242e2/direct-mapped-cache.png"
        srcset="/static/2537f1b00624247a7162ad22755fa7cd/772e8/direct-mapped-cache.png 200w,
/static/2537f1b00624247a7162ad22755fa7cd/e17e5/direct-mapped-cache.png 400w,
/static/2537f1b00624247a7162ad22755fa7cd/242e2/direct-mapped-cache.png 703w"
        sizes="(max-width: 703px) 100vw, 703px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>Tags and Valid Bits</p>
<ul>
<li>
<p>How do we know which particular block is stored in a cache location?</p>
<ul>
<li>Store block address as well as the data</li>
<li>Actually, only need the high-order bits</li>
<li>Called the tag</li>
</ul>
</li>
<li>
<p>What if there is no data in a location?</p>
<ul>
<li>Valid bit: 1 = present, 0 = not present</li>
<li>Initially 0</li>
</ul>
</li>
</ul>
</li>
<li>
<p>MIPS Direct Mapped Cache Example</p>
<ul>
<li>One word blocks, cache size = 1K words (or 4KB)
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 377px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c799b7d033198e8ecc691a751f6b4313/6146e/mips-direct-mapped-cache-example.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACoklEQVQ4y2WT6W7bRhRG/f5v0Efon6JogAapV6GRbCdRvCSSKFIUd3HVYlFcxO10OLJdFB3wcgZDzpm7fPes4zT6ues6urblbex2O/I8F986tmKdpimt+F5kOZHh8PP7I9Xu8Aro5Pmz/tWmBd2hfAfVdS3nMIoIHA9PM7CXwkwL31uh3T+iD77hPs0p00z+++bGGXVLpBh4ik4YhsTrBGU2w9R0ooWFO56yvLwjmOmkps/i05Dtg0aXHf91ICvQxs/S8zPajr0byts9dcl26RIvbNSHH6jfn/HnYm8iLjy/Z3UzZvNVIXciyrKkDndUqw3HqYv6YUBVlAIoRllVBFGI8TyjesnINy/4QYA+neN6LpYIdxevWSdrdumeVRhgir2NuWIdJdJLe65TC44EFnmBL36yRJht3UAjSiRS4dsC5thEscilME1fYJomschtHMenM5Ylgc5UpT6+AYtCHtZHD/jKklh3WIvQxx8HnP/6J3//ccXt3QMXnwYMLocML4ZcfbhkdHPP6PpWVn5jr2iq+s3DHP9xTjqzRT4jtiKUxPRQLm4ZfrxC+fqEtzCZfHtCVVSUicLnv64xHZf5XJNy2ToBTf0K7BPseR5110pB5vsMQ19iPk4Z3o1YOCahCFlR55i2halojO+/ECYRpmXKkPvC/g/YC1g+ZS1S2LC3Q35+/sLTzUgWJI5iNtstK93i9vwad2EQGDbHbYo906R+/wMMRGWTJDmZOJzMDJa/XaP+8jttWb3rru8mUxMFUhc4uiHXvUpOwhYjyzJJ7+feDocDe6G1SLOYDO7I3PjUDUIBPbjrXntVaLjNj3RFRZOkNIfiBOz7tQcdj0fpbW/9+kVoLtms33u97jX6wyKfWJS6TyPgR39D6SSU3ppmn/MP7IXLhKVO77cAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="mips-direct-mapped-cache-example"
        title="mips-direct-mapped-cache-example"
        src="/static/c799b7d033198e8ecc691a751f6b4313/6146e/mips-direct-mapped-cache-example.png"
        srcset="/static/c799b7d033198e8ecc691a751f6b4313/772e8/mips-direct-mapped-cache-example.png 200w,
/static/c799b7d033198e8ecc691a751f6b4313/6146e/mips-direct-mapped-cache-example.png 377w"
        sizes="(max-width: 377px) 100vw, 377px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>Example: Larger Block Size</p>
<ul>
<li>
<p>64 blocks, 16 bytes/block</p>
<ul>
<li>To what block number does address 1200 map?</li>
</ul>
</li>
<li>Block address = 1200 / 16 = 75</li>
<li>Block number = 75 modulo 64 = 11
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 738px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5c2516b8510f6a5090f5e2c8d3150352/774b6/example-larger-block-size.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 26%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAzElEQVQY03WQyQqEQAxE/f9/Eg+CngT14MWDBxX3fUHcaqYCPSMDUxDopJPXldbw1nEcuK4L/3TfN7Ztw3menxrPzxky2KcxieMYSZJgWRYMw4C+77Guq5ynaUJd13BdF2maSg/vsixDFEUoikJyzvMRbd93NE0jDuZ5BnPf92HbttQUgNA8z6VumibatkUYhjAMQyIIAnGs0SZdMAikO8/zoOs6yrIU4DiO6LpOoI7jCFTl7LUsC1VVfVf+/S8CCHr+mRLd8k5Jbab0AmbBfM6ql8o0AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="example-larger-block-size"
        title="example-larger-block-size"
        src="/static/5c2516b8510f6a5090f5e2c8d3150352/774b6/example-larger-block-size.png"
        srcset="/static/5c2516b8510f6a5090f5e2c8d3150352/772e8/example-larger-block-size.png 200w,
/static/5c2516b8510f6a5090f5e2c8d3150352/e17e5/example-larger-block-size.png 400w,
/static/5c2516b8510f6a5090f5e2c8d3150352/774b6/example-larger-block-size.png 738w"
        sizes="(max-width: 738px) 100vw, 738px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>Multiword Block Direct Mapped Cache</p>
<ul>
<li>Four word/block, cache size = 1K words
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 462px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/789c11f8b3a72efc617f43407f87cfe4/e389b/multiword-block-direct-mapped-cache.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACVElEQVQoz12TeW/TQBDF8/2/BEgg/oEKCVEkilCLVFpo0ya1Hd+OncPxlTjOfefH2BYSYqTRjnZ33sy+edtYLBaUdj6f6/V0Io5ilsslaZKQF1NS1aX/3EF5brNY1vf/tdPxSBpGHA4HGmXi8XyqfC7g06JgNp/jdbsMwlBAU3p3LSZWwH674yQFZ/mUgeEyMjy2WcFhtyfUHMqWGpkkGM02Vkul8/CM29aI3UASHByJI6vLbr2pqq/X63ot5szTCQvxTTplUywYdXtVt41oGOK3dFzboeu4DPuD6qlZmhKFI0LpcpxPGEURjutWcenpZMx4mlceCVhft2vAgdNlHIR0DB3TtjHUDl3Tpuf5uJaNrZv4tosnrisanpwFpoPZVunJXmC5dO6aOC+dGjCUJ5Wk/7y+5abZQr36hf3pFvPqAe/yN8aHG5pvvvDy9itPrz7Ten2JenGNfvGDzrtvKO+/o3y8xm1pNWAiZC/TnPv7ex4eH7EsC9O00DrSqethS6y8KAReF9swMXWjOrOFHk1VMeW+oxlYj+0aMIsSZlmOoiooioJhGHieAMnzS94GI6FD1/F7AX4QYJgmrnBZcus4Dq4nvAs9Q5lyDZhlTMZjkjhB0zTyPK8mmchgJnHKZBAROB6+dFQW96XrdJwxEz3GacJ6v4PdkSIY1YBlcmlxHJPKZKn1zSFfsLFDtn7CapgxapuMnnTilsmyF1d7a/FNnJP3o0peFeBqtWKz2VCIoEvR/v0159P5v99wYj0REc9WJMGAaZiwL5ZsxwWFH1a6LO0PO/op3OxOFS8AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="multiword-block-direct-mapped-cache"
        title="multiword-block-direct-mapped-cache"
        src="/static/789c11f8b3a72efc617f43407f87cfe4/e389b/multiword-block-direct-mapped-cache.png"
        srcset="/static/789c11f8b3a72efc617f43407f87cfe4/772e8/multiword-block-direct-mapped-cache.png 200w,
/static/789c11f8b3a72efc617f43407f87cfe4/e17e5/multiword-block-direct-mapped-cache.png 400w,
/static/789c11f8b3a72efc617f43407f87cfe4/e389b/multiword-block-direct-mapped-cache.png 462w"
        sizes="(max-width: 462px) 100vw, 462px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>Block Size Considerations</p>
<ul>
<li>
<p>Larger blocks should reduce miss rate</p>
<ul>
<li>Due to spatial locality</li>
</ul>
</li>
<li>
<p>But in a fixed-sized cache</p>
<ul>
<li>
<p>Larger blocks -> fewer of them</p>
<ul>
<li>More competition -> increased miss rate</li>
</ul>
</li>
<li>Larger blocks -> pollution</li>
</ul>
</li>
<li>
<p>Larger miss penalty</p>
<ul>
<li>Can override benefit of reduced miss rate</li>
<li>Early restart and critical-word-first can help</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Cache Misses</p>
<ul>
<li>On cache hit, CPU proceeds normally</li>
<li>
<p>On cache miss</p>
<ul>
<li>Stall the CPU pipeline</li>
<li>Fetch block from next level of hierachy</li>
<li>
<p>Instruction cache miss</p>
<ul>
<li>Restart instruction fetch</li>
</ul>
</li>
<li>
<p>Data cache miss</p>
<ul>
<li>Compleete data access</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Write-Through</p>
<ul>
<li>
<p>On data-write hit, could just update the block in cache</p>
<ul>
<li>But then cache and memory would be inconsistent</li>
</ul>
</li>
<li>Write through: also update memory</li>
<li>
<p>But makes writes take longer</p>
<ul>
<li>
<p>e.g., if base CPI = 1, 10% of instructions are stores, write to memory takes 100 cycles</p>
<ul>
<li>Effective CPI = 1 + 0.1 * 100 = 11</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Solution: write buffer</p>
<ul>
<li>Holds data waiting to be written to be written memory</li>
<li>
<p>CPU continues immediately</p>
<ul>
<li>Only stalls on write if write buffer is already full</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Write-Back</p>
<ul>
<li>
<p>Alternative: On data-write hit, just update the block in cache</p>
<ul>
<li>Keep track of whether each block is dirty</li>
</ul>
</li>
<li>
<p>When a dirty block is replaced</p>
<ul>
<li>Write it back to memory</li>
<li>Can use a write buffer to allow replacing block to be read first</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Wirte Allocation</p>
<ul>
<li>What should happen on a write miss?</li>
<li>
<p>Alternatives for write-through</p>
<ul>
<li>Allocate on miss: fetch the block</li>
<li>
<p>Write around: don't fetch the block</p>
<ul>
<li>Since programs often write a whole block before reading it (e.g., initialization)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>For write-back</p>
<ul>
<li>Usually fetch the block</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Example: Intrinsity FastMATH</p>
<ul>
<li>
<p>Embedded MIPS processor</p>
<ul>
<li>12-stage pipeline</li>
<li>Instruction and data access on each cycle</li>
</ul>
</li>
<li>
<p>Split cache: separate I-cache and D-cache</p>
<ul>
<li>Each 16KB: 256 blocks * 16 words/block</li>
<li>D-cache: write-through or write-back</li>
</ul>
</li>
<li>
<p>SPEC2000 miss rates</p>
<ul>
<li>I-cache: 0.4%</li>
<li>D-cache: 11.4%</li>
<li>Weighted average: 3.2%
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4c5dcd0119f8517f98367aed9e636e03/8740f/example-intrinsity-fast-math.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 63.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABjElEQVQ4y22TC5OCMAyE+f+/z7sTH6MOKCACKgr47PVbJwze2ZlO2ibZzaZt8Hw+3XAy2rZ16/XapWnq4jjWerPZuMfjIb/FDXNsH7gPo+s6V5aly/NcQEmSyN7v9zegIbCRBafTSYF1Xauy6/WqCRi+4/EoX5ZlssMBELkUcDgcXoAkFkUhaVSCw/aAQcJ+t9uJ4Hw+93a/36sd5LEXYFVVSlitVupZTVW+EqoB0GSzp3IImfiwVMma2QPC3ngGWEw2AF3XSg7Bl8tF8qiOmNvtphjOrTUChGWxWLjR6MuNw9CFk6m3E82Q6fffP2MX+RY0TfOKkT900+lMrbF2CBAWZM3mcy85U/Nj35ftdqsW2PNBCZWn3m/nxFDtm2QAaW7i+4TFYYysy7KQpTokWzIxqIPkn2QOYGMNYxRFOoNguVz2t4rPkrlZwBh2gf07RA43aQE03N6jSSfBFEAMARdmn8DeaGA3B+jwW9maW6QaEiBiDxEWMCyV9+/QKvn7P4dfi0R7LvTy0zR1vymU5y3i1FAvAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="example-instrinsity-fastmath"
        title="example-instrinsity-fastmath"
        src="/static/4c5dcd0119f8517f98367aed9e636e03/5a190/example-intrinsity-fast-math.png"
        srcset="/static/4c5dcd0119f8517f98367aed9e636e03/772e8/example-intrinsity-fast-math.png 200w,
/static/4c5dcd0119f8517f98367aed9e636e03/e17e5/example-intrinsity-fast-math.png 400w,
/static/4c5dcd0119f8517f98367aed9e636e03/5a190/example-intrinsity-fast-math.png 800w,
/static/4c5dcd0119f8517f98367aed9e636e03/8740f/example-intrinsity-fast-math.png 1106w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>5.4 Measuring and Improving Cache Performance</h3>
<ul>
<li>
<p>Measuring Cache Performance</p>
<ul>
<li>
<p>Components of CPU time</p>
<ul>
<li>
<p>Program execution cycles</p>
<ul>
<li>Includes cache hit time</li>
</ul>
</li>
<li>
<p>Memory stall cycles</p>
<ul>
<li>Mainly from cache misses</li>
</ul>
</li>
</ul>
</li>
<li>
<p>With simplifying assumptions:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Memory stall cycles
= Memory accesses/Program * Missrate * Miss penalty
= Instructions/program * Misses/Instruction * Miss penalty</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Cache Performance Example</p>
<ul>
<li>
<p>Given</p>
<ul>
<li>I-cache miss rate = 2 %</li>
<li>D-cache miss rate = 4 %</li>
<li>Miss penalty = 100 cycles</li>
<li>Base CPI (ideal cache) = 2</li>
<li>Load &#x26; stores are 36% of instructions</li>
</ul>
</li>
<li>
<p>Miss cycles per instruction</p>
<ul>
<li>I-cache: 0.02 * 100 = 2</li>
<li>D-cache: 0.36 * 0.04 * 100 = 1.44</li>
</ul>
</li>
<li>
<p>Actual CPI = 2 + 2 + 1.44 = 5.44</p>
<ul>
<li>Ideal CPU is 5.44/2 = 2.72 times faster</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Average Access Time</p>
<ul>
<li>Hit time is also important for performance</li>
<li>
<p>Average memory access time (AMAT)</p>
<ul>
<li>AMAT = Hit time + Miss rate * Miss penalty</li>
</ul>
</li>
<li>
<p>Example</p>
<ul>
<li>CPU with 1ns clock, hit time = 1 cycle, miss penalty = 20 cycles, I-cache miss rate = 5%</li>
<li>
<p>AMAT = 1 + 0.05 * 20 = 2ns</p>
<ul>
<li>2 cycles per instruction</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Performance Summary</p>
<ul>
<li>
<p>When CPU performance increased</p>
<ul>
<li>Miss penalty becomes more significant</li>
</ul>
</li>
<li>
<p>Decreasing base CPI</p>
<ul>
<li>Greater proportion of time spent on memory stalls</li>
</ul>
</li>
<li>
<p>Increasing clock rate</p>
<ul>
<li>Memory stalls account for more CPU cycles</li>
</ul>
</li>
<li>Can't neglect cache behavior when evaluating system performance</li>
</ul>
</li>
<li>
<p>Associative Caches</p>
<ul>
<li>
<p>Fully associative</p>
<ul>
<li>Allow a given block to go in any cache entry</li>
<li>Requires all entries to be searched at once</li>
<li>Comparator per entry (expensive)</li>
</ul>
</li>
<li>
<p>n-way set associative</p>
<ul>
<li>Each set contains n entries</li>
<li>
<p>Block number determines which set</p>
<ul>
<li>(Block number) modulo (#Sets in cache)</li>
</ul>
</li>
<li>Search all entries in a given set at once</li>
<li>n comparators (less expensive)</li>
</ul>
</li>
</ul>
</li>
<li>Associative Cache Example
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f0fa6428fae8e8368eb9e6058fda0604/d74fe/associative-cache-example.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 44.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABmklEQVQoz01Sy07cQBD0/9848A85RAhy4AgLiogUkkMAgYCQJd7Frx2P7bG99nhtV7omDNqWWmN3d/WrOsC7JEmCKIqwXC7RNA32JYpirFYrhGGIuq6dbZ5nTNOEUOwel+c5Al1odF0HXRTQYsjSFG3bOhDt/G6bGlVVoZAY2nxCKou7mLbBYC2CsixhTI26KnDx4xGL7w+w3f+Efd+j225xfH6HOFXSgQLjvYzjiFIKMf7q1xI3zxGCYRgQy7jj0OH06hGnXx+AyUp1gD612eDw8zUiSWhMJZ0al8xKNxyVk02CPb64x+LnHwS73Q6FVLVdjS+X9zhZ3GIee9nP7NTaHgefvmEVZyhlPb5DP26ea+xsi6OzO5xd/0bgl9vUBi9hipe/CWzfOYCXm6c1cl24ZPuEEedsgn1+jbFONAI6tNaiBaqSxKgPJikko9TKvUrl7vVCkqiVMQ7LxI4UngzfzUa5fXqWmZi+9dubWz7Pwhjz4UvlIqhZlrmTUkrJ2Uh3ZNOPwJ36HRFMoPfvCzvdygVQGcN/xv0DDEitTIjELKQAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="associative-cache-example"
        title="associative-cache-example"
        src="/static/f0fa6428fae8e8368eb9e6058fda0604/5a190/associative-cache-example.png"
        srcset="/static/f0fa6428fae8e8368eb9e6058fda0604/772e8/associative-cache-example.png 200w,
/static/f0fa6428fae8e8368eb9e6058fda0604/e17e5/associative-cache-example.png 400w,
/static/f0fa6428fae8e8368eb9e6058fda0604/5a190/associative-cache-example.png 800w,
/static/f0fa6428fae8e8368eb9e6058fda0604/d74fe/associative-cache-example.png 1164w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>Spectrum of Associativity</p>
<ul>
<li>For a cache with 8 entries
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/453da329b8f98da91152a95468c4d36a/6d74e/spectrum-of-associativity.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABAElEQVQoz5VSSQ6DMAzM/7+HxI0jO4gdwha3Y9U0pFC1ESMnwRl7bCsi8/zMyxgGVhiG5Ps+eZ5HXdfR1RJfeyk67szJaRgGStOU4jjmO601VVVFZVky9n2/JFV3GS7LwqTITvZZllGSJBwEAW4IzxLEYZ5nJmuahtZ15TMyrOua7U+EtgMetG3LBNu2MRAAwD2y/osQNUJmk574MQhx/taQg1B+ujXs+56iKKIgCA4URcFlEF/3rbqLKISQB5nYi1yUwfa398qNAqkCjAc6m+c5jxAszuM40m7efh8ZCiHqJHMGyIjAyh4AMf6L/BOhnSGiQSqABgDSDNcC0ixb4QMZR10UIZXsOgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="sepctrum-of-associativity"
        title="sepctrum-of-associativity"
        src="/static/453da329b8f98da91152a95468c4d36a/5a190/spectrum-of-associativity.png"
        srcset="/static/453da329b8f98da91152a95468c4d36a/772e8/spectrum-of-associativity.png 200w,
/static/453da329b8f98da91152a95468c4d36a/e17e5/spectrum-of-associativity.png 400w,
/static/453da329b8f98da91152a95468c4d36a/5a190/spectrum-of-associativity.png 800w,
/static/453da329b8f98da91152a95468c4d36a/6d74e/spectrum-of-associativity.png 1085w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>Associativity Example</p>
<ul>
<li>
<p>Compare 4-block caches</p>
<ul>
<li>Direct mapped, 2-way set associative, fully associative</li>
<li>Block access sequence: 0, 8, 0, 6, 8</li>
</ul>
</li>
<li>Direct mapped
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/94a838d90cd7f79070171c5b007b2cc4/c0255/direct-mapped.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABIklEQVQY0z2RzXKDMAyEef+H6Uzv7QO0nRzI0AQIJoCx+YeEhOa41aqZHjyS5fXnlRykaYqqqtD3PU6nk+Z1XSNJEhRFga5rMQ4DvHM4Ho+qYYzjWDWMbdvqfe89gjAMVTDPM6IoUsg0TXBySEEj4sJ5WAEaY1CWpcY8zzVyUUcoa0HXdbohsGkaDOKGwCzL4GXfC6iODqgzg/V2w+PxUO26rv/59XrFtm3aWUCrXMuyKHgcRwV+i1srLw9pAvf6gvrzA7NAtvtdH53nBfftR/PL5aJAay0CbevpzIkbOuYDBFYisOI0fH9DsttherrhuTmX2B9imPwsZv4cc1wBqbRKMHNCufhZhXyQzw3c1yeszJkjYBfUcnZ7mT/nxhpNsf4LSOC4E7V3Ro4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="direct-mapped"
        title="direct-mapped"
        src="/static/94a838d90cd7f79070171c5b007b2cc4/5a190/direct-mapped.png"
        srcset="/static/94a838d90cd7f79070171c5b007b2cc4/772e8/direct-mapped.png 200w,
/static/94a838d90cd7f79070171c5b007b2cc4/e17e5/direct-mapped.png 400w,
/static/94a838d90cd7f79070171c5b007b2cc4/5a190/direct-mapped.png 800w,
/static/94a838d90cd7f79070171c5b007b2cc4/c0255/direct-mapped.png 920w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>2-way set associative
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/046ae14e5e6f0abef23871e4ce7176af/4255a/2-way-set-associative.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABHElEQVQY001R2W6EMAzk//+n18Puy6pSpQoqtOUS17IcCTeogtepJ1ukPjiZOPZ4bFtBECDPc/R9jyiKkKYplFKgP0kSgwf567rO+IIwhO/7xkLBnuchyzIM42hiLTpINM8z4jg2n8Qs0LYtlNYY5X0vS9i2DdU0qKvKiOA/c8mxruuDkAdt/KvAIGKqI3knxGGUi6WGfP7ZMMwLhmHAvu9YlsXkbNtmfBYPGlWxLWIGFfcCVVlB9xon94SL9w6tFa7OF66uazogCZUd5BRiFUWBUtqhuv/4MaMIZXHDx/kFn5czbjIS7/kJ32+vUqzENE1GXSUjoKC6rmHx0chcSMKbpqW1TJbDlrUEtY4DJaqY4MsiuAzGHXM+MO9f6S62RcKJJZ8AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="2-way-set-associative"
        title="2-way-set-associative"
        src="/static/046ae14e5e6f0abef23871e4ce7176af/5a190/2-way-set-associative.png"
        srcset="/static/046ae14e5e6f0abef23871e4ce7176af/772e8/2-way-set-associative.png 200w,
/static/046ae14e5e6f0abef23871e4ce7176af/e17e5/2-way-set-associative.png 400w,
/static/046ae14e5e6f0abef23871e4ce7176af/5a190/2-way-set-associative.png 800w,
/static/046ae14e5e6f0abef23871e4ce7176af/4255a/2-way-set-associative.png 915w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>Fully associative
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d9ab468424d11f04755a844a7ff7f803/4255a/fully-associative.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABF0lEQVQY0z2QbYuCUBSE/f//Jwi3MmFNaZPIlCKw1FVTr5kvBdGXZ72X3f1w4dwZzsyc0aIoYrPZcDwesW2bxWKBZVkEQYDv+4RhiBCVeofDgf1+rzjP8xQv5yRJqKoKqaVlWabEJOg4DvP5XAkWRUEcxzRNQ30fEE3PvW15PJ8Mjwft79x1HcMw8H6/yfMcLU1TtSwdTNNkOp1iGIZyk4mKa4EbuKy2K6I44vydEUbJiF8Z+p5aCLUvDVRC+SnLUiWRJ/8llG6n04mu7bA9C9M1SPMUy7Fwty7i1pCJmrK+0Y8pX68X8lpNdiSTyOXZbMZkMkHX9f+eJL521nyaFjt/x4erY4zikjOWS77G/s/nkMvloqr7AfZQY/x+DPH/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="fully-associative"
        title="fully-associative"
        src="/static/d9ab468424d11f04755a844a7ff7f803/5a190/fully-associative.png"
        srcset="/static/d9ab468424d11f04755a844a7ff7f803/772e8/fully-associative.png 200w,
/static/d9ab468424d11f04755a844a7ff7f803/e17e5/fully-associative.png 400w,
/static/d9ab468424d11f04755a844a7ff7f803/5a190/fully-associative.png 800w,
/static/d9ab468424d11f04755a844a7ff7f803/4255a/fully-associative.png 915w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>How Much Associativity</p>
<ul>
<li>
<p>Increased associativity decreases miss rate</p>
<ul>
<li>But with diminishing returns</li>
</ul>
</li>
<li>
<p>Simulation of a system with 64KB</p>
<ul>
<li>
<p>D-cache, 16-word blocks, SPEC2000</p>
<ul>
<li>1-way: 10.3%</li>
<li>2-way: 8.6%</li>
<li>4-way: 8.3%</li>
<li>8-way: 8.1%</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Set Associative Cache Organization
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/03a9834a1934407a6d620ccb7871c408/d2c2a/set-associative-cache-organization.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABqUlEQVQ4y4WUiW7CQAxE+f9voxK0AQpECfd9J9yH2zeSIYmoupK163h37Jn1pmS/4/F4yIprxuVykfnIxt6NUhYkC5amqe33e+t2u9ZqteQfj8e3SXOA7wJ8O51ONp/Pbblc2mazsfF4LNBi8mIhqpDD2+3WkiSx1WolINZRFNn5fFYc/78BqAB3u52ojUYjGwwG1uv15E+nU/n9fl8JD4eDLRYLGYk4BwP8+/3+qpDN6/VaBwBhA5uh6j5xZqi7DLPZTHEYweIJiDYEh8OhlcsfVq83rN0OVWmlUrXgq6Y1l1Otflqj8W2TyUT7gqCmOUnSvIZkBTAMQ1XhlUVRLNpoC3WkIA6DOI7lY94BAqR8DOEJerWAMgOAvj5jJMDYQ7XX6/UFiHYAkpUqmDEHpB/RkIPohY9MAKM/1T3bJvtCeBHQZEYGEmG32023Cpi3F7eKzznAc7fsoHwEAEDoAM5FdDodazab6ktoM7tE7IVNrrGzne7VAA6lIAgEjrYkYA0gibw32Z9r7L/ep78S7wR05MK82T2WZZmjXHyX0EGf4qBK/wMV/1Q/+heBcTbvFjkAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="set-associative-cache-organization"
        title="set-associative-cache-organization"
        src="/static/03a9834a1934407a6d620ccb7871c408/5a190/set-associative-cache-organization.png"
        srcset="/static/03a9834a1934407a6d620ccb7871c408/772e8/set-associative-cache-organization.png 200w,
/static/03a9834a1934407a6d620ccb7871c408/e17e5/set-associative-cache-organization.png 400w,
/static/03a9834a1934407a6d620ccb7871c408/5a190/set-associative-cache-organization.png 800w,
/static/03a9834a1934407a6d620ccb7871c408/d2c2a/set-associative-cache-organization.png 929w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>Replacement Policy</p>
<ul>
<li>Direct mapped: no choice</li>
<li>
<p>Set associative</p>
<ul>
<li>Prefer non-valid entry, if there is one</li>
<li>Otherwise, choose among entries in the set</li>
</ul>
</li>
<li>
<p>Least-recently used (LRU)</p>
<ul>
<li>
<p>Choose the one unused for the longest time</p>
<ul>
<li>Simple for 2-way, manageable for 4-way, too hard beyond that</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Random</p>
<ul>
<li>Gives approximately the same performance as LRU for high associativity</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Multilevel Caches</p>
<ul>
<li>
<p>Primary cache attached to CPU</p>
<ul>
<li>Small, but fast</li>
</ul>
</li>
<li>
<p>Level-2 cache services misses from primary cache</p>
<ul>
<li>Larger, slower, but still faster than main memory</li>
</ul>
</li>
<li>Main memory services L-2 cashe misses</li>
<li>Some high-end systems include L-3 cache</li>
</ul>
</li>
<li>
<p>Multilevel Cache Example</p>
<ul>
<li>
<p>Given</p>
<ul>
<li>CPU base CPI = 1, clock rate = 4GHz</li>
<li>Miss rate/instruction = 2%</li>
<li>Main memory access time = 100ns</li>
</ul>
</li>
<li>
<p>With just primary cache</p>
<ul>
<li>Miss penalty = 100ns/0.25ns = 400 cycles</li>
<li>Effective CPI = 1 + 0.02 * 400 = 9</li>
</ul>
</li>
<li>
<p>Now add L-2 cache</p>
<ul>
<li>Access time = 5ns</li>
<li>Global miss rate to main memory = 0.5%</li>
</ul>
</li>
<li>
<p>Primary miss with L-2 hit</p>
<ul>
<li>Penalty = 5ns/0.25ns = 20cycles</li>
</ul>
</li>
<li>
<p>Primary miss with L-2 miss</p>
<ul>
<li>Extra penalty = 500 cycles</li>
</ul>
</li>
<li>CPI = 1 + 0.02 * 20 + 0.005 * 400 = 3.4</li>
<li>Performance ratio = 9/3.4 = 2.6</li>
</ul>
</li>
<li>
<p>Multilevel Cache Considerations</p>
<ul>
<li>
<p>Primary cache</p>
<ul>
<li>Focus on minimal hit time</li>
</ul>
</li>
<li>
<p>L-2 cache</p>
<ul>
<li>Focus on low miss rate to avoid main memory access</li>
<li>Hit time has less overall impact</li>
</ul>
</li>
<li>
<p>Results</p>
<ul>
<li>L-1 cache usually smaller than a single cache</li>
<li>L-1 block size smaller than L-2 block size</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Interactions with Advanced CPUs</p>
<ul>
<li>
<p>Out-of-order CPUs can execute instructions during cache miss</p>
<ul>
<li>Pending store stays in load/store unit</li>
<li>
<p>Dependent instructions wait in reservation stations</p>
<ul>
<li>Independent instructions continue</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Effect of miss depends on program data flow</p>
<ul>
<li>Much harder to analyes</li>
<li>Use system simulation</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Interactions with Software</p>
<ul>
<li>
<p>Misses depend on memory access patterns</p>
<ul>
<li>Algorithm behavior</li>
<li>Compiler optimization for memory access</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>5.6 Virtual Machines</h3>
<ul>
<li>pass</li>
</ul>
<h3>5.7 Virtual Memory</h3>
<ul>
<li>
<p>Virtual Memory</p>
<ul>
<li>
<p>Use main memory as a "cache" for secondary (disk) storage</p>
<ul>
<li>Managed jointly by CPU hardware and the operating system (OS)</li>
</ul>
</li>
<li>
<p>Programs share main memory</p>
<ul>
<li>Each gets a private virtual address space holding its frequently used code and data</li>
<li>Protected fro other programs</li>
</ul>
</li>
<li>
<p>CPU and OS translate virtual addresses to phsyical addresses</p>
<ul>
<li>VM "block" is called a page</li>
<li>VM translation "miss" is called a page fault</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Address Translation</p>
<ul>
<li>Fixed-size pages (e.g., 4K)
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/464527498909edbb0a3e1cc91695c391/7388e/address-translation.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 43%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABI0lEQVQoz52SyW6DQBBE5/8/KrIsm0vsQxIFn2IOMWJfbGwDZunwWpqIkJzSUomZ3qooMPKPKMtSoiiSx+Pxq2biOBZQ17WiaRo5n8+SJInkeS593+sCzlVVyfV61butcyZHjXnj+754nqeMNNAIQZZlChbSeL/fJU1TrUGIOnIsCsNQbrebijGfp5Mcj0dtZGkQBIrL5aLs4zh+g4CAWObs3ex2e9k6jrK0batM9jVYOh/8mIg3W0fr85h7adzDQd5dV1U+7/fy8vo2KQz1dYBVwxCAcBgG6bruB1BJ3lSTEpTFk3er9UaeVmtVgkKGrQK8xVN85FkUhYI8FnGm38ylwwLbMqwiPg4fBHtYzALIIOfJvFmaPjd8mbeBFfj713/4BQRItluQBwiPAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="address-translation"
        title="address-translation"
        src="/static/464527498909edbb0a3e1cc91695c391/5a190/address-translation.png"
        srcset="/static/464527498909edbb0a3e1cc91695c391/772e8/address-translation.png 200w,
/static/464527498909edbb0a3e1cc91695c391/e17e5/address-translation.png 400w,
/static/464527498909edbb0a3e1cc91695c391/5a190/address-translation.png 800w,
/static/464527498909edbb0a3e1cc91695c391/7388e/address-translation.png 1104w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
<li>
<p>Virtual Addressing with a Cache</p>
<ul>
<li>Thus it takes an extra memory access to translate a VA to a PA
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d7883e5c44f65ecf696a3bc469384e67/dc333/virtual-addressing-with-a-cache.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/ElEQVQY001Q2aqDUAz0/79I8A/El4obFGyp+1Kt+1rnMoFTbiAcE5NZop3niX3fcRwHpmnCtm24rgvsM8dx/PX4Mjk7DAPWdZWZ7/crPX5rXKjrGk3TwLIsuK6LKIoki6KQXhAEiONYZj6fD57PJ0zThOM4yPNc6jRN0bYttK7rZKHveyzLIkxJksAwDFmY5xmMLMsQhiE8zxMiBlX7vg9d13G73fB+v6FxgWBEpyrWZHs8Hni9Xqiq6lfTCRURmDt0pxwQkHMCyB+8H+2UZSlKqY6q6MC2bSFkXwngCUjA+6ugYg3/gsclKEHu97swkkg54KuS9iiEICoZf8Y9xFMTdB9XAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="virtual-addressing-with-a-cache"
        title="virtual-addressing-with-a-cache"
        src="/static/d7883e5c44f65ecf696a3bc469384e67/5a190/virtual-addressing-with-a-cache.png"
        srcset="/static/d7883e5c44f65ecf696a3bc469384e67/772e8/virtual-addressing-with-a-cache.png 200w,
/static/d7883e5c44f65ecf696a3bc469384e67/e17e5/virtual-addressing-with-a-cache.png 400w,
/static/d7883e5c44f65ecf696a3bc469384e67/5a190/virtual-addressing-with-a-cache.png 800w,
/static/d7883e5c44f65ecf696a3bc469384e67/dc333/virtual-addressing-with-a-cache.png 938w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>This makes memory (cache) accesses very expensive (if every access was really two accesses)</li>
<li>The hardware fix is to use a Translation Lookaside Buffer (TLB) - a small cache that keeps track of recently used address maapings to avoid having to do a page table lookup</li>
</ul>
</li>
<li>
<p>Page Fault Penalty</p>
<ul>
<li>
<p>On page fault, the page must be fetched from disk</p>
<ul>
<li>Takes millions of clock cycles</li>
<li>Handled by OS code</li>
</ul>
</li>
<li>
<p>Try to minimize page fault rate</p>
<ul>
<li>Fully associative placement</li>
<li>Smart replacement algorithms</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Page Tables</p>
<ul>
<li>
<p>Stores placement information</p>
<ul>
<li>Array of page table entries, indexed by virtual page number</li>
<li>Page table register in CPU points to page table in physical memory</li>
</ul>
</li>
<li>
<p>If page is present in memory</p>
<ul>
<li>PTE stores the physical page number</li>
<li>Plus other status bits (referenced, dirty, ...)</li>
</ul>
</li>
<li>
<p>If page is not present</p>
<ul>
<li>PTE can refer to location in swap space on disk</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Two Programs Sharing Physical Memory</p>
<ul>
<li>
<p>A Program's address space is divided into pages (all one fixed size) or segments (variable sizes)</p>
<ul>
<li>The starting location of each page (either in main memory or in secondary memory) is contained in the program's page table
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f3d0a3a159238f6274c1db9b579197e8/2c95d/two-programs-sharing-physical-memory.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8UlEQVQoz1WS527jQAyE/f4vdsD9CYw4uRi21a3edtXbfkfJVymMViLEITXDkzGGPbZ+Yikb1mZgGyZWQRsXBH6AdX+Qfdn0z5xF95h1YxtnVnle24FFyVm3mM1w+k24VC2jkzJYMWs3MhQK13W5fFw4n8+4gY9/s9jmhdcEUqeHF/6JP4RHp6Q+Jt2jqzRJmvIMAqIoQmlFpxrMKISC+uriXa743995fjszpfWLcL+ZacFIpx1jrtBFRWR5OLbD/XHHljOMI9IgZFItxflGkeVUjaJqG/IoQd18tnbktM0rbVpSlyWWFH9eLtgfV2LHx/u8iYY+cfikSjJiN2AuNM0jFDKNVtJca+qqRgUpa9FwWqeZzE9IqgbPj7HfH6T2k2mcGIMMZSfUom1jx0xtSxkkhF8BpdK0QtZITqUFyksOk067gpPu6GTcshpInYLaK6ncgmfUcY9Hrs8BP5+IAimWb5y3G1WtmLaFvu/RUU4T5q9fPpQUViMvRoyZRQLdzKRegXOP8ayUUMzykgpfcvO40vspxfud2g0pP21K0a9LymOdDpeP65fbrwaGJlEEYYbl5QfyqpRc/lqXfWtkzRYvYxPdzDAfQ/112Zj/cOxl01P9cMSQkmw3Is6oBUp0a9sOJe7qvqUWc/acEoO6ruMn8QP5q3KhFF4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="two-programs-sharing-physical-memory"
        title="two-programs-sharing-physical-memory"
        src="/static/f3d0a3a159238f6274c1db9b579197e8/5a190/two-programs-sharing-physical-memory.png"
        srcset="/static/f3d0a3a159238f6274c1db9b579197e8/772e8/two-programs-sharing-physical-memory.png 200w,
/static/f3d0a3a159238f6274c1db9b579197e8/e17e5/two-programs-sharing-physical-memory.png 400w,
/static/f3d0a3a159238f6274c1db9b579197e8/5a190/two-programs-sharing-physical-memory.png 800w,
/static/f3d0a3a159238f6274c1db9b579197e8/2c95d/two-programs-sharing-physical-memory.png 1099w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
<li>Translation Using a Page Table
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4d1846143c8068d4b975584aaf483b1a/636c2/translation-using-a-page-table.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 76.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABnklEQVQ4y32UiXLCMAxE+f/vK7SFFAYSAuEOkINwCJ4660lLqWc0dmRrtVrL6dxuN2uaxu18PrtdLhefl8ulzWYzt6IojHG9XsO50+nkswZYHRZVVflmXde+xliXZenr/X5v4/HYoiiyOI7DWUiQnCSAMRxQG7vdzrbbra3Xazsej84KH5amqTNerVZ2OBx85pz2SfAEiJMS+AYQgMVi4UYwe6oC0OFw6GfENgBKC5wEAy6mMMFHID5pyMjz3GOlXwDUITJlWRZKAoAglcWaPdbIgZFcgH4pQpYTVgTBarPZeOky/N+AeQAU2yeGap1ur2cfn/1gg+jL3rq9h//d+oPIjXX2SFhV5d+A0J5MJjadTv02KYlWUYnz+dw1lA8pXjL8XTJNTKDKI0h6qmxA/y1ZH8zo1m5yZAAQw4+PhmdNgpcMKZtyeQkY2bUHI4Lbt8nAh/4/nl4bEA2TJPEbhqFaAkaUCisS6VkiAzMmpgGQTHpuBGAwI4Eui5YSOBKMRiO/LL7D02vrp7+IWghGAKArzwwAugG/NERTYlT6HfjFh7tzUn3mAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="translation-using-a-page-table"
        title="translation-using-a-page-table"
        src="/static/4d1846143c8068d4b975584aaf483b1a/5a190/translation-using-a-page-table.png"
        srcset="/static/4d1846143c8068d4b975584aaf483b1a/772e8/translation-using-a-page-table.png 200w,
/static/4d1846143c8068d4b975584aaf483b1a/e17e5/translation-using-a-page-table.png 400w,
/static/4d1846143c8068d4b975584aaf483b1a/5a190/translation-using-a-page-table.png 800w,
/static/4d1846143c8068d4b975584aaf483b1a/636c2/translation-using-a-page-table.png 911w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>Mapping Pages to Storage
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/89001b51cf8ace6a1928a3199d1772cf/90712/mapping-pages-to-storage.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 74.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACGklEQVQ4y3VUiY6iUBD0/79LnbiDmIws4BpHxwsVD5DDA6G2qxEcZ9dO2vcij6rqet00IBHHMcIw1LycL/gZRVHcU/a4r/V/j2Q0+LPfH9BsNjUJzrheL0iTFGmaPgBQ1AT/C/6vgKfTCdvtVoD3yLIMuTwYDAboGgb6fQtJkjwpZfgbH7PZDKvVCvP5HIFUpwqrA5dLWerxGGGxWGAymcBxbLiugyiK7xLKJZIzK2+lgN7SU0Df95Hn+QPwfD4rO0v8ErAwCBV4uVxqpukJt9tNfZ5+TbH1t6o8FvBECMMgEJuuz4B5XgKSkTZQwXQ6VWDaQRXr9VoIPN0T/BAcEAhYZdc/CqMogm3b2Gw26H/0pWxH/ZwLOAmolqCsgKQUwORlPgHSw7O0zEaYTdNUD3u9Hox3A++dXwq22+30ZZIpKBUeDpp8dgcs3a6Aj8ejAo7HY3TNLjqdjrYTAXiGxpOcZVa9y6pIRI9rhfRPb1AeDlxXGVm6ZVkYDod6AQTiSwze7h+xwrEdtaFqqUbZsI9mJWOr1YLruGi32nhrv2npVM5bpFdUy1aK40SJKIKKVSG+jVI5IVdtch7mqv7IypJ4cczR6BOG0RVLeppG14TneWUfoqj79eVIlZbkSlYCjhTQFDAm92ylurFfDn1eZl4UNSk39MyyfovHjvrM8fRkcvJqlh83/ePL8uKLUqnNrpm2Cve37KakfwGYf3pSwnJxgAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="mapping-pages-to-storage"
        title="mapping-pages-to-storage"
        src="/static/89001b51cf8ace6a1928a3199d1772cf/5a190/mapping-pages-to-storage.png"
        srcset="/static/89001b51cf8ace6a1928a3199d1772cf/772e8/mapping-pages-to-storage.png 200w,
/static/89001b51cf8ace6a1928a3199d1772cf/e17e5/mapping-pages-to-storage.png 400w,
/static/89001b51cf8ace6a1928a3199d1772cf/5a190/mapping-pages-to-storage.png 800w,
/static/89001b51cf8ace6a1928a3199d1772cf/90712/mapping-pages-to-storage.png 882w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>Replacement and Writes</p>
<ul>
<li>
<p>To reduce page fault rate, prefer least-recently used (LRU) replacement</p>
<ul>
<li>Reference bit (aka use bit) in PTE set to 1 on access to page</li>
<li>Periodically cleared to 0 by OS</li>
<li>A page with reference bit = 0 has not been used recently</li>
</ul>
</li>
<li>
<p>Disk writes take millions of cycles</p>
<ul>
<li>Block at once, not individual locations</li>
<li>Write through is impractical</li>
<li>Use write-back</li>
<li>Dirty bit in PTE set when page is written</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Fast Translation Using a TLB</p>
<ul>
<li>
<p>Address translation would appear to require extra memory references</p>
<ul>
<li>One to access the PTE</li>
<li>Then the actual memory access</li>
</ul>
</li>
<li>
<p>But access to page tables has good locality</p>
<ul>
<li>So use a fast cache of PTEs within the CPU</li>
<li>Called a Translation Look-aside Buffer (TLB)</li>
<li>Typical: 16-612 PTEs, 0.5-1 cycle for hit, 10-100 cycles for miss, 0.01%-1% miss rate</li>
<li>Misses could be handled by hardware or software</li>
</ul>
</li>
</ul>
</li>
<li>
<p>A TLB in the Memory Hierarchy
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f424df61808472d1f72df6f20b6515a5/4255a/a-tlb-in-the-memory-hierarchy.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 38.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABP0lEQVQoz12S2a6CQBBE+f9vIvHBqMFEw4ML0bjhCoL7hluZ08nckFtJM8x0T1FdjXe73XQ4HHQ8HrVer7Xf71UUhc7ns77fr5rNphaLhcDpdLIc9fP5XNfrVZ/Px+per5etHoTb7dYIwzDUcDhUkiQaDAb2gXq9rvF4rOVyqc1mY+toNFKv17N36qMoUp7nut/v8i6Xix1CyCHgQqVSUbvdNtLn82lkkBDUApT6vq9qtWoCjJDWaAWVKIGs3+/bOpvNlKap4jhWt9sV3VA/mUzMBhd0tFqtrG2Px+Px0Pv9tgMUcJmi3W6nLMss2JMHeAcpiv7DK28oQCmKGo2GptOpKXBWONAyOewCDMOF514ASlHCBIMgsDbY41UZKHRTLhP+KSwT4h3FnU5HtVrN2meKeIn5rVbL8vwRbjhlwh9F/VlvpqqDlgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="a-tlb-in-the-memory-hierarchy"
        title="a-tlb-in-the-memory-hierarchy"
        src="/static/f424df61808472d1f72df6f20b6515a5/5a190/a-tlb-in-the-memory-hierarchy.png"
        srcset="/static/f424df61808472d1f72df6f20b6515a5/772e8/a-tlb-in-the-memory-hierarchy.png 200w,
/static/f424df61808472d1f72df6f20b6515a5/e17e5/a-tlb-in-the-memory-hierarchy.png 400w,
/static/f424df61808472d1f72df6f20b6515a5/5a190/a-tlb-in-the-memory-hierarchy.png 800w,
/static/f424df61808472d1f72df6f20b6515a5/4255a/a-tlb-in-the-memory-hierarchy.png 915w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<ul>
<li>
<p>A TLB miss - is it a page fault or merely a TLB miss?</p>
<ul>
<li>
<p>If the page is loaded into main memory, then the TLB miss can be handled (in hardware or software) by loading the translation information from the page table into the TLB</p>
<ul>
<li>Takes 10's of cycles to find and load the translation info into the TLB</li>
</ul>
</li>
<li>
<p>If the page is not in main memory, then it's a true page fault</p>
<ul>
<li>Takes 1,000,000's of cycles to service a page fault</li>
</ul>
</li>
</ul>
</li>
<li>TLB misses are much more frequent than true page faults</li>
</ul>
</li>
<li>Fast Translation Using a TLB
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2359ab62afa4ad19d99ae199fe5895c1/ad997/fast-translation-using-a-tlb.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACBElEQVQ4y31Ui3KiQBD0///Ju1RpmWjO8lTOBxIEBXyAID7BV2d7UktMcslWDYuzsz09PYOl2+2GPM/FrtcrPq/VaoXdbofL5YLT6VT4ee+zcZUI0m63Ua1WMZlMsFgssF6vBXyz2cj7bDZDp9NGEARfAO4XfSU+eDFNUyyXS3WxA9/3kSQJwjDEfD6X96k/F7Z5nhUA+/1e2G+324J9iQ+yOZ/PiONYAMlSB9LHZI63hOsvEcYpzkqZZJ1iPB5LVdyjKHoHJNgxOwrDVqsl++FwECAGJskawSLCIowQpzsBNS1bznViViklE/BecAa4riss6dfssyzHbn9AGMVwpx4s25XErIBJuRcMNSA1oV6e58EwDAwGgwL4eHyrwB478IM5JtOpxGr9aR8AOTbsIjvOrrIxvV4PlmVJMM/InI16k2Mj1ZAEjb4CUI8Bu9hsNoUVL9q2LUBkxp3Al8u1GBH6HMcRAhqjdD9THJFy+ZcqdQhzNELj+RndriEXN0p4VkI9KQ9jWUWgwDzP/6ihBmSmcrmMfr+PwXCIx6dHdLodKUcmQemoS7ReXvBUb6De+KPi6pLgv4C/Hx7QU4D9/gC1Wg0jxZT6EoyWZRnOiuFUNcUw/klcV+2U5Qsgs1QqFQxNE6Y5wl/VIN8PZHT0COnF3wQXu/sfeG/K3ff40/ruO9Znr2VMKfPefc1OAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="fast-translation-using-a-tlb"
        title="fast-translation-using-a-tlb"
        src="/static/2359ab62afa4ad19d99ae199fe5895c1/5a190/fast-translation-using-a-tlb.png"
        srcset="/static/2359ab62afa4ad19d99ae199fe5895c1/772e8/fast-translation-using-a-tlb.png 200w,
/static/2359ab62afa4ad19d99ae199fe5895c1/e17e5/fast-translation-using-a-tlb.png 400w,
/static/2359ab62afa4ad19d99ae199fe5895c1/5a190/fast-translation-using-a-tlb.png 800w,
/static/2359ab62afa4ad19d99ae199fe5895c1/ad997/fast-translation-using-a-tlb.png 1012w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>TLB Misses</p>
<ul>
<li>
<p>If page is in memory</p>
<ul>
<li>Load the PTE from memory and retry</li>
<li>
<p>Could be handled in hardware</p>
<ul>
<li>Can get complex for more complicated page table structures</li>
</ul>
</li>
<li>
<p>Or in software</p>
<ul>
<li>Raise a special exception, with optimized handler</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If page is not in memory (page fault)</p>
<ul>
<li>OS handles fetchiing the page and updating the page table</li>
<li>Then restart the faulting instruction</li>
</ul>
</li>
</ul>
</li>
<li>
<p>TLB Miss Handler</p>
<ul>
<li>
<p>TLB miss indicates</p>
<ul>
<li>Page present, but PTE not in TLB</li>
<li>Page not preset</li>
</ul>
</li>
<li>
<p>Must recognize TLB miss before destination register overwritten</p>
<ul>
<li>Raise exception</li>
</ul>
</li>
<li>
<p>Handler copies PTE from memory to TLB</p>
<ul>
<li>Then restarts instruction</li>
<li>If page not present, page fault will occur</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Page Fault Handler</p>
<ul>
<li>Use faulting virtual address to find PTE</li>
<li>Locate page on disk</li>
<li>
<p>Choose page to replace</p>
<ul>
<li>If dirty, write to disk first</li>
</ul>
</li>
<li>Read page into memory and update page table</li>
<li>
<p>Make process runnable again</p>
<ul>
<li>Restart from faulting instruction</li>
</ul>
</li>
</ul>
</li>
<li>
<p>TLB and Cache Interaction</p>
<ul>
<li>
<p>If cache tag uses physical address</p>
<ul>
<li>Need to translate before cache lookup</li>
</ul>
</li>
<li>
<p>Alternative: use virtual address tag</p>
<ul>
<li>
<p>Complications due to aliasing</p>
<ul>
<li>Different virtual addresses for shared physical address
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/40c6bcefb4f9a39f1994546dae39565f/6af66/tlb-and-cache-interaction.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 107.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAACeklEQVQ4y22VyZLqMAxF+f+fYtmPJSyaqQkkQMI8Q5j1dJRWSKfiKpUcWZavrmSnJr/j/X5L1Xg8HnK/301XDd/nulb8eL1ecj6f5Xq95rb9fi9RFMlwOJTj8Whr+N1uNxP8PnKTmn84mvV6LcvlUiaTiYzHY9PYCLzdbmU+n1vwJEnkcrmU0D4zhIxiWgTEGQERdlChse12OwnDUDabjWUE8ufzmaUMOoycTCCcVqpxABUBOSxNL5YiPshisTBf1g6Hg/lZQE6M49jS6PZ6Uq/X5evrn4TK22gUmgSBrnW7NgfZz89A/Uc6j0zHmj6BLSCpIMlsJmPlq9FoSKvVkpXyBgrQzBQ9a9gQgibJzNZWq5UsVe7326fKDCCDlgLAiVfRBRsUoCkUBQIV3+zJUi5VuTzg0YWNcJWmqR1MVmgOwfanD8uN6sIG0uopt0in05FgGCiXI+Octmq321YcEBO49rcxM+F0Bo5UH2fSol1Op5PNCbj+5XMwGMh0OrUsrCgzLYgXAO1zgpGS8whP3pcE9tt12B8+KcMP0L3aCIveqASnkvBHcLTfHOfQfdlnHNKHpIcBBDS6n4idVL0YaNCDym8TtvymcCIpg4JApAIXzF28XVyKfmg4hhILSEogbDab0u335Vsr2VbpdHtKxSS/ux6gLNhZzwOSGgtUiYW5HsDN2Ooc9KABAfNK0b1/EPqTRUXZDD8E9oHNA4MGyaj4zKEkv8tOOoEcDST7YBNdMAqzh8H6Lgiyh8O+I308gnxPreo5L86pHkWbKCXQEseJ3pq+HTJV7pFI52l6/XBYvM/ledXgvSxmUflPKQcsBy3aoMVf93JW/wGDhJ12LKjfgwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="tlb-and-cache-interaction"
        title="tlb-and-cache-interaction"
        src="/static/40c6bcefb4f9a39f1994546dae39565f/6af66/tlb-and-cache-interaction.png"
        srcset="/static/40c6bcefb4f9a39f1994546dae39565f/772e8/tlb-and-cache-interaction.png 200w,
/static/40c6bcefb4f9a39f1994546dae39565f/e17e5/tlb-and-cache-interaction.png 400w,
/static/40c6bcefb4f9a39f1994546dae39565f/6af66/tlb-and-cache-interaction.png 640w"
        sizes="(max-width: 640px) 100vw, 640px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Memory Protection</p>
<ul>
<li>
<p>Different tasks can share parts of their virtual address spaces</p>
<ul>
<li>But need to protect against errant access</li>
<li>Requires OS assistance</li>
</ul>
</li>
<li>
<p>Hardware support for OS protection</p>
<ul>
<li>Privileged supervisor mode (aka kernel mode)</li>
<li>Privileged instructions</li>
<li>Page tables and other state information only accessible in supervisor mode</li>
<li>System call exception (e.g., syscall in MIPS)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>5.8 A Common Framework for Memory Hierarchies</h3>
<ul>
<li>
<p>The Memory Hierarchy</p>
<ul>
<li>
<p>Common principles apply at all levels of the memory hierarchy</p>
<ul>
<li>Based on notions of caching</li>
</ul>
</li>
<li>
<p>At each level in the hierarchy</p>
<ul>
<li>Block placement</li>
<li>Finding a block</li>
<li>Replacement on a miss</li>
<li>Write policy</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Block Placement</p>
<ul>
<li>
<p>Determined by associativity</p>
<ul>
<li>
<p>Direct mapped (1-way associative)</p>
<ul>
<li>One choice for placement</li>
</ul>
</li>
<li>
<p>n-way set associative</p>
<ul>
<li>n choices within a set</li>
</ul>
</li>
<li>
<p>Fully associative</p>
<ul>
<li>Any location</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Higher associativity reduces miss rate</p>
<ul>
<li>Increases complexity, cost, and access time</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Finding a Block
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/38b3877838d59ad0b003f6786c75c3d1/350de/finding-a-block.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 33%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABIUlEQVQoz1WRia6CMBRE+f9Pw7jhioCocQWXBATBbV7OTWrymkxob9tzp4O3WCy0XC4Vx7G2262u16vyPLd5mqaKokhJkmg2m9n6crnodDr96txjzne9XsvzfV/z+VxBENi3LEs9Hg9tNhurrVYr7fd7gwF6v992BggA9h2MBt5gMBAuR6ORJpOJsixTXde22e12tdvtDIBzxD5g1LatNW+aRs/nU8fjUZ4D0cWN7/droOl0ai45g4bDoel2u+l+v//O45pBHF6n07F8xuOxuSI/HPIE6uRLFC7P8/msqqosBgTkn0OegFjgCiCDDPv9vrkHyPMBfj4fFUVhBnjV4XAw2Ov1shg8B3ECTucwDO1Sr9czGKIGAPfAcOuMUOcH/QGETgF51SirEgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="finding-a-block"
        title="finding-a-block"
        src="/static/38b3877838d59ad0b003f6786c75c3d1/5a190/finding-a-block.png"
        srcset="/static/38b3877838d59ad0b003f6786c75c3d1/772e8/finding-a-block.png 200w,
/static/38b3877838d59ad0b003f6786c75c3d1/e17e5/finding-a-block.png 400w,
/static/38b3877838d59ad0b003f6786c75c3d1/5a190/finding-a-block.png 800w,
/static/38b3877838d59ad0b003f6786c75c3d1/350de/finding-a-block.png 998w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<ul>
<li>
<p>Hardware caches</p>
<ul>
<li>Reduce comparisons to reduce cost</li>
</ul>
</li>
<li>
<p>Virtual memory</p>
<ul>
<li>Full table lookup makes full associativity feasible</li>
<li>Benefit in reduced miss rate</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Replacement</p>
<ul>
<li>
<p>Choice of entry to replace on a miss</p>
<ul>
<li>
<p>Least recently used (LRU)</p>
<ul>
<li>Complex and costly hardware for high associativity</li>
</ul>
</li>
<li>
<p>Random</p>
<ul>
<li>Close to LRU, easier to implement</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Virtual memory</p>
<ul>
<li>LRU approximation with hardware support</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Wirte Policy</p>
<ul>
<li>
<p>Write-through</p>
<ul>
<li>Update both upper and lower levels</li>
<li>Simplifies replacement, but may require write buffer</li>
</ul>
</li>
<li>
<p>Write-back</p>
<ul>
<li>Update upper level only</li>
<li>Update lower level when block is replaced</li>
<li>Need to keep more state</li>
</ul>
</li>
<li>
<p>Virtual memory</p>
<ul>
<li>Only write-back is feasible, given disk write latency</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Sources of Misses</p>
<ul>
<li>
<p>Compulsory misses (aka cold start misses)</p>
<ul>
<li>First access to a block</li>
</ul>
</li>
<li>
<p>Capacity misses</p>
<ul>
<li>Due to finite cache size</li>
<li>A replaced block is later accessed again</li>
</ul>
</li>
<li>
<p>Conflict misses (aka collision misses)</p>
<ul>
<li>In a non-fully associative cache</li>
<li>Due to competition for entries in a set</li>
<li>Would not occur in a fully associative cache of the same total size</li>
</ul>
</li>
</ul>
</li>
<li>Cache Design Trade-offs
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e294dbbf4f389255fd256dfcf57c1618/47aef/cache-design-trade-offs.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 49.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABVElEQVQoz3WS266CQAxF5/8/jQdjEEEEFVQuykVEE7k81Kwmc8KDp8nOzLSd3d3OmCRJZL/fC2sURXI+n+X5fMr9fpfdbifH41Fjp9NJ903TyPV6lTiO1Xc4HHTPerlcxBCs61q6rtO173vB3u+3tG2r5PiIPx4PmaZJCziOI1VVqQ8QL8tSDMwWKLB7FIZhqMCPepRAjvLtdvunzsaLohCTZZmqoIJVwZnV930FZ1pF8TAMqhCS5T1AjqFvmPM8VzACgI+qQRDI7XYTCjMSDELUkYOfe8yeuM4QZloEdp6ooS3P89RHDit+HoNidIEfpfM86z2TpqlWQSnkVCPp9XrJZrNR2A5sLnBdV8fBPCmAGHIMrL/s8/noA9hXXxoEq9VKv9vyERmNoYVfxvf4z1DCbAEKaX8cR30wQ5D/ZGcIONMW/2rptyr4SpAx4/V6rYS25S+ymOdZCqXTNAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="cache-design-trade-offs"
        title="cache-design-trade-offs"
        src="/static/e294dbbf4f389255fd256dfcf57c1618/5a190/cache-design-trade-offs.png"
        srcset="/static/e294dbbf4f389255fd256dfcf57c1618/772e8/cache-design-trade-offs.png 200w,
/static/e294dbbf4f389255fd256dfcf57c1618/e17e5/cache-design-trade-offs.png 400w,
/static/e294dbbf4f389255fd256dfcf57c1618/5a190/cache-design-trade-offs.png 800w,
/static/e294dbbf4f389255fd256dfcf57c1618/47aef/cache-design-trade-offs.png 1063w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
<h3>5.9 Using a Finite State Machine to Control A Simple Cache</h3>
<ul>
<li>
<p>Cache Control</p>
<ul>
<li>
<p>Example cache characteristics</p>
<ul>
<li>Direct-mapped, write-back, write allocate</li>
<li>Block size: 4 words (16 bytes)</li>
<li>Cache size: 16 KB (1024 blocks)</li>
<li>32-bit byte addresses</li>
<li>Valid bit and dirty bit per block</li>
<li>
<p>Blocking cache</p>
<ul>
<li>CPU waits until access is complete
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 709px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a51835eb6df1487df689c2b0b6447281/4d08a/cache-control.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 23%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0klEQVQY03VQywqDMBDM/3+PHgSvKuJBRNBLEBRU8P1CPahTZqGHtnRhCdnZeSSqbVs8z4N/ta4ruLPv+8f8PE8cxyHNosayLFBaa4zjKJe+79F1HeZ5xjRNMivLEkmSoKoq2aM48bquURQFsixD0zQyz/Mcats2cWdT0DRNxHEszsR4Uox4EASwLAuu64oZRWzbhmEYMqe4YhI6kkwHLjuOI+IkESORT0/TFJ7nIQxDwZiYHN/3EUWR7Kjvf6EB+77vn/9k2mEYxORd13WJOQOxXnzZeBtoTo21AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="cache-control"
        title="cache-control"
        src="/static/a51835eb6df1487df689c2b0b6447281/4d08a/cache-control.png"
        srcset="/static/a51835eb6df1487df689c2b0b6447281/772e8/cache-control.png 200w,
/static/a51835eb6df1487df689c2b0b6447281/e17e5/cache-control.png 400w,
/static/a51835eb6df1487df689c2b0b6447281/4d08a/cache-control.png 709w"
        sizes="(max-width: 709px) 100vw, 709px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Interface Signals
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5b7e37444125ce5d400c9c13cfca5abb/26a94/interface-signals.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABiElEQVQoz22SyU7DQBBE/f8fwQE4IA6cQQgUgYgQ4pJIOIlMlH1zNjuJnT2FXycDOdDSqMdT3dVV4/H2+72m06lms5nl9Xqt5XKpNE11OBxsPxwOFUfRLw62Wq0Mj7Lz6ITN53N5FNAAOBqNVKvVVCqVVK/XlSSJnTGM6Pf7qlQqtjqdjhG3223DNpuNxuOxPDZxHNkhk1qtlhqNhhUsFgtrQA3B4Gq1qjAMtd1ujQBiAkGo9BwzasiNZlOFQsGIGAA5RJPJRIPBQMF3oGKxaLXdbldBENgenGWEzhYZAixhm+9mNoBCBmIZhb7v29Wgjm+s0/9LiBKCSdbw5ZtCisJBmFleG97r9WxQuVw22/QxxIVZ5qewcYSoomi328m9AM6owyK2UQKOMmp5Cdw3dR6AuyOyCy7Z/T17VnGsNLPtAjIGchVxhrEg9lwzxGQWhcd8JJ1nlq+eXnX5mNPFw7Pu8h9K0qX+C88pOVfGkRGesChJdZv/1M3Lu65zb7ov+Fpttmf1f+sH/zr3oEt1HvsAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="interface-signals"
        title="interface-signals"
        src="/static/5b7e37444125ce5d400c9c13cfca5abb/5a190/interface-signals.png"
        srcset="/static/5b7e37444125ce5d400c9c13cfca5abb/772e8/interface-signals.png 200w,
/static/5b7e37444125ce5d400c9c13cfca5abb/e17e5/interface-signals.png 400w,
/static/5b7e37444125ce5d400c9c13cfca5abb/5a190/interface-signals.png 800w,
/static/5b7e37444125ce5d400c9c13cfca5abb/26a94/interface-signals.png 1102w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
<li>
<p>Finite State Machines
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 527px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/eedd276383a2cc5d4165daa0a78fae0e/44385/finite-state-machines.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 89.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACG0lEQVQ4y4VU23abMBDk/7+ufcxJmjSu49iAuEkCcZ3OSoBlO232HCEQ0jA7s0uyLAvmef52yL4twv3iZ7ldsM4cST+M6NyAcZw5pocxDBOmaYa2HSrdYuBaAPp6JM6N/uC/YuNV1BanrIFpB/wvEteP/qtbKq+nEj+fL/jxfMbLQe2pCuBn3sAyG9P1qI3zs+3Cs257SrMEwJhhVlm8EfTXR4mzavZ1ATymNRk6VKYjuEbRtFxvkXOkpcFIaW4AY+G3aMmo4x5VGXxmmoD99ynHgN71aOSlxaXQyAqDnOzFxHjvoykPDK8v4yiZ3sZOUpNSwl4u6xksj6bc15sILaGo4UVplo+jISyhpuP7+eGcB5Q6i0OcE+3iEFM+0oZMHfW0Xgostwx3QM0SqHTnh3z9/bPC71Phn0u/5pCqoKO4LO5mdBXLrTxeQ7lIwf651DhcKs4NUpowUHwBPJLV4VzRGIOJuhmmrOoVMG6AjWFIUQrT+eIUjawL4juCKmqlGsv1HttetTJMK+ke7Q3bGXp9eOiUG5zZCVKwwkzirAye3jM8HXK8Hgu6O6GlvhtD0V4MHaer44lc5EVaWLwcla+1UBLwPw35wCmv2UHG16BksDG8dnr408hz8lV3bCEfKnVoNc+KOirfanYHvJqyMryvo/heCl56tfKgzrtdrxVRMJObMyvb5B7oHlzS7PlPDPO4P0sVxPvWnPEXFtWAuyMI12UAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="finite-state-machines"
        title="finite-state-machines"
        src="/static/eedd276383a2cc5d4165daa0a78fae0e/44385/finite-state-machines.png"
        srcset="/static/eedd276383a2cc5d4165daa0a78fae0e/772e8/finite-state-machines.png 200w,
/static/eedd276383a2cc5d4165daa0a78fae0e/e17e5/finite-state-machines.png 400w,
/static/eedd276383a2cc5d4165daa0a78fae0e/44385/finite-state-machines.png 527w"
        sizes="(max-width: 527px) 100vw, 527px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<ul>
<li>Use an FSM to sequence control steps</li>
<li>
<p>Set of states, transition on each clock edge</p>
<ul>
<li>State values are binary encoded</li>
<li>Current state stored in a register</li>
<li>Next state = fn(current state, surrent inputs)</li>
</ul>
</li>
<li>Control output signals = f0(current state)</li>
</ul>
</li>
<li>Cache Controller FSM
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a6b8c7313b23811ccfe7604a7585f431/97655/cache-controller.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6UlEQVQ4y4WTSW/bMBCF9f//S5GL6+ZQOzefGsBw4qV2vcm7vO+7p/wGGYFyNgKURPLpzZvhm0DcuF6vcjqdZD6f6zwcDrLb7eR4PMp4PJZGoyGj0Uj31+u1dDod6Xa70u/3Fce43W76DnhcLhc5n886+d5utzIYDmWz2cQ/MyEjYK1Wk0qlImEYysvrS0zGOzCFRLcRdkL58/wss9lMFaIOJeAGg4ES9lyAQqEgqZ+pmEwJjX25XMq/el2KxaKk0mlZrVZxAMNAiGoCvjrcj4cHqbty2JmmbMyMaBxJqVyWrVcXO6MU+/1ey8K71Wq5EmwSAeOU/U1/7ZNRksViIe12W/eo5XQ6TWDjlP0ISPfJWaOIG4ew7DJAZbPZ1Nu3VN/V0I9i68lkomR2IRBVq1W9KM745jxB+FnKQ2ebKIo0VYjuMb4rEjX0VfEjSrALCjC7kfk/g8GrPlGC0MiMgOjYhsuwOtoEQzDUk/qHnWLGxvn5fF7BpVJJOwNSWoxO4Rwfss7lcorDu34d4xqSgraYazXskH58VCX3KbMmEFgIfjkcAS5vuMD3Gt6izTLZrPzOZLSPscp9nUi16tqPjso+PSnOPBn4YFTSKX/f7ACQvXuj48mm65Rur6ff4ChFQuFXneKffYf7D6wV0ZkkwyL5AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="cache-controller"
        title="cache-controller"
        src="/static/a6b8c7313b23811ccfe7604a7585f431/5a190/cache-controller.png"
        srcset="/static/a6b8c7313b23811ccfe7604a7585f431/772e8/cache-controller.png 200w,
/static/a6b8c7313b23811ccfe7604a7585f431/e17e5/cache-controller.png 400w,
/static/a6b8c7313b23811ccfe7604a7585f431/5a190/cache-controller.png 800w,
/static/a6b8c7313b23811ccfe7604a7585f431/97655/cache-controller.png 819w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
<h3>5.10 Parallelism and Memory Hierarchies: Cache Coherence</h3>
<ul>
<li>
<p>Cache Coherence Problem</p>
<ul>
<li>
<p>Suppose two CPU cores share a physical address space</p>
<ul>
<li>Write-through caches
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6f0291debffdb97e142644aa48ad3fa5/77672/cache-coherence-problem.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 39.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABNElEQVQoz02SW6+CQAyE9///MX32wQgm3lHAGwioIGbcrzlNDklTum1nZgfC4/HQ8XjU5XJRVVW63+86HA46n8+q69rqoih0Op3s7Hq92jw1O2VZKssyFWVh+4GhyWSi7Xarvu/1fD61XC6V57mGYVDbtrYwnU6VpqmaptF8PrcaQMiSJDERgAcU7HY7UzKOo77fr/z5fD4GCAns/g4o9ev1MhFk9lAfbrebNQnYyJzRZBhL3u+3LTkYRJB3XWfBPH0UBxYJrr5YLLRarTSbzZTE6/1XxjCeEoAA7EGPMzCCq2MQH/EOCzAeDwFFEYuuFOVNVE7fb4FilAbQ+WIAYe5mszHT1+u1Ae/3e1OIx2ZHzG0kb6KaKuYq1vSYwbLgHrhvBF+L7Od+C/+tat7/CJyIQOkPzUBc+gntegcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="cache-coherence-problem"
        title="cache-coherence-problem"
        src="/static/6f0291debffdb97e142644aa48ad3fa5/5a190/cache-coherence-problem.png"
        srcset="/static/6f0291debffdb97e142644aa48ad3fa5/772e8/cache-coherence-problem.png 200w,
/static/6f0291debffdb97e142644aa48ad3fa5/e17e5/cache-coherence-problem.png 400w,
/static/6f0291debffdb97e142644aa48ad3fa5/5a190/cache-coherence-problem.png 800w,
/static/6f0291debffdb97e142644aa48ad3fa5/77672/cache-coherence-problem.png 1060w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Coherence Defined</p>
<ul>
<li>Informally: Reads return most recently written value</li>
<li>
<p>Formally: </p>
<ul>
<li>P writes X; P reads X (no intervening writes)
-> read returns written value</li>
<li>
<p>P1 writes X; P2 reads X (sufficiently later)
-> read returns written value</p>
<ul>
<li>c.f. CPU B reading X after step 3 in example</li>
</ul>
</li>
<li>
<p>P1 writes X, P2 writes X
-> all processors see writes in the same order</p>
<ul>
<li>End up with the same final value for X</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Cache Coherence Protocols</p>
<ul>
<li>
<p>Operations performed by caches in multiprocessors to ensure coherence</p>
<ul>
<li>
<p>Migration of data to local caches</p>
<ul>
<li>Reduces bandwidth for shared memory</li>
</ul>
</li>
<li>
<p>Replication of read-shared data</p>
<ul>
<li>Reduces contention for access</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Snooping protocols</p>
<ul>
<li>Each cache monitors bus reads/writes</li>
</ul>
</li>
<li>
<p>Directory-based protocols</p>
<ul>
<li>Caches and memory record sharing status of blocks in a directory</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Invalidating Snooping Protocols</p>
<ul>
<li>
<p>Cache gets exclusive access to a block when is to be written</p>
<ul>
<li>Broadcasts an invalidate message on the bus</li>
<li>
<p>Subsequent read in another cache misses</p>
<ul>
<li>Owning cache supplies updated value
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ebdff64a6b1be35a0f250ed6c16aee02/e3829/invalidating-snooping-protocols.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 31.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA60lEQVQY001R2QqEQAzz/7/NB+8DPPBGxftCQbKkyyz7UNtJp0mmalEUIQgCOI6DLMuwrqtknl3XRZ7nGMcRZVnCMAwkSYKmaWCapsy1bSt3yZOmKTQC933jOA7J7/sK6Xmegj3PI/i2bYjjGH3fC87huq6lnudZMkU1fggwpmmSBh0xlmURnCT7vuO6rh+BEuIdFULo+z4sy/oFG3ySrutgz7ZteTrxrutEVInTNethGMQA16OFYSi78DwPrKuqkobaIXtUpkMOcx0kJxndslYiRVF8CTlIJxxW1vkDKMLgwkn0vxpFyvqf8AM2f7zcKu9r8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="invalidating-snooping-protocols"
        title="invalidating-snooping-protocols"
        src="/static/ebdff64a6b1be35a0f250ed6c16aee02/5a190/invalidating-snooping-protocols.png"
        srcset="/static/ebdff64a6b1be35a0f250ed6c16aee02/772e8/invalidating-snooping-protocols.png 200w,
/static/ebdff64a6b1be35a0f250ed6c16aee02/e17e5/invalidating-snooping-protocols.png 400w,
/static/ebdff64a6b1be35a0f250ed6c16aee02/5a190/invalidating-snooping-protocols.png 800w,
/static/ebdff64a6b1be35a0f250ed6c16aee02/e3829/invalidating-snooping-protocols.png 1077w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Memory Consistency</p>
<ul>
<li>
<p>When are writes seen by other processors</p>
<ul>
<li>"Seen" means a read returns the written value</li>
<li>Can't be instantaneously</li>
</ul>
</li>
<li>
<p>Assumptions</p>
<ul>
<li>A write completes only when all processors have seen it</li>
<li>A processor does not reorder writes with other accesses</li>
</ul>
</li>
<li>
<p>Consequence</p>
<ul>
<li>P writes X then writes Y
-> all processors that see new Y also see now X</li>
<li>Processors can reorder reads, but not writes</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>5.13 The ARM Cortex-A8 and Intel Core i7 Memory Hierarchies</h3>
<ul>
<li>pass</li>
</ul>
<h3>5.14 Going Faster: Cache Blocking and Matrix Multiply</h3>
<ul>
<li>pass</li>
</ul>
<h3>5.15 Fallacies and Pitfalls</h3>
<ul>
<li>
<p>Pitfalls</p>
<ul>
<li>
<p>Byte vs. word addressing</p>
<ul>
<li>
<p>Example: 32-byte direct-mapped cache, 4-byte blocks</p>
<ul>
<li>Byte 36 maps to block 1</li>
<li>Word 36 maps to block 4</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Ignoring memory system effects when writing or generating code</p>
<ul>
<li>Example: iterating over rows vs. columns of arrays</li>
<li>Large strides result in poor locality</li>
</ul>
</li>
<li>
<p>In multiprocessor with shared L2 or L3 cache</p>
<ul>
<li>Less associativity than cores results in conflict misses</li>
<li>More cores -> need to increase associativity</li>
</ul>
</li>
<li>
<p>Using AMAT to evaluate performance of out-of-order processors</p>
<ul>
<li>Ignores effect of non-blocked accesses</li>
<li>Instead, evaluate performance by simulation</li>
</ul>
</li>
<li>
<p>Extending address range using segments</p>
<ul>
<li>E.g., Intel 80286</li>
<li>But a segment is not always big enough</li>
<li>Makes address arithmetic complicated</li>
</ul>
</li>
<li>
<p>Implementing a VMM on an ISA not designed for virtualization</p>
<ul>
<li>E.g., non-privileged instructions accessing hardware resources</li>
<li>Either extend ISA, or require guest OS not to use problematic instructions</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>5.16 Concluding Remarks</h3>
<ul>
<li>
<p>Concluding Remarks</p>
<ul>
<li>
<p>Fast memories are small, large memories are slow</p>
<ul>
<li>We really want fast, large memory</li>
<li>Caching gives this illusion</li>
</ul>
</li>
<li>
<p>Principle of locality</p>
<ul>
<li>Programs use a small part of their memory space frequently</li>
</ul>
</li>
<li>
<p>Memory hierarchy</p>
<ul>
<li>L1 cache &#x3C;-> L2 cache &#x3C;-> ... &#x3C;-> DRAM memory &#x3C;-> disk</li>
</ul>
</li>
<li>Memory system design is critical for multiprocessors</li>
</ul>
</li>
</ul></div><div></div></main><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-181031687-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/computerArchitecture/5-large-and-fast-exploiting-memory-hierarchy/2020-10-04 09:00:00 +0900";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-d8b803c152e4e53a0b70.js"],"component---src-pages-404-js":["/component---src-pages-404-js-c7869fa3e5c9d31ecb8e.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ff371c780530ee3e7cbf.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-b63e06953e40f148ff6b.js"],"component---src-templates-post-template-jsx":["/component---src-templates-post-template-jsx-21e5cdc1750e46a29022.js"]};/*]]>*/</script><script src="/webpack-runtime-92b8d634de3575c5751f.js" async=""></script><script src="/styles-9b6f388623a2ec93d35f.js" async=""></script><script src="/framework-d54fcf3f0204b459cf2d.js" async=""></script><script src="/app-d8b803c152e4e53a0b70.js" async=""></script><script src="/component---src-templates-post-template-jsx-21e5cdc1750e46a29022.js" async=""></script></body></html>