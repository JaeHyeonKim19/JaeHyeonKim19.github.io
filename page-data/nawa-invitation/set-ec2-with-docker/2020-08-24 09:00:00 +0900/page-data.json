{"componentChunkName":"component---src-templates-post-template-jsx","path":"/nawa-invitation/set-ec2-with-docker/2020-08-24 09:00:00 +0900","result":{"pageContext":{"html":"<p><a href=\"https://pjh3749.tistory.com/261\">젠킨스 설치</a></p>\n<p>ec2를 생성하고 맥에서 접속한다.</p>\n<p>현재 아마존 리눅스 1을 사용하고 있으므로 자바8 설치, 타임존 변경을 진행한다.</p>\n<p>자바8 설치 및 적용</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo yum install -y java-1.8.0-openjdk-devel.x86_64\n\nsudo /usr/sbin/alternatives --config java\n\n# 자바8선택\n\n# 사용하지않는 7버전 삭제\nsudo yum remove java-1.7.0-openjdk\n\n# 자바버전 확인\njava -version</code></pre></div>\n<p>타임존 한국시간으로 변경</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo rm /etc/localtime\nsudo ln -s /usr/share/zoneinfo/Asia/Seoul /etc/localtime\n\n# 시간 적용 확인\ndate</code></pre></div>\n<p>도커 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo yum -y install docker\n\n# 설치되었는지 버전 확인\ndocker --version</code></pre></div>\n<p>도커에 자동 배포를 위한 젠킨스를 띄워보자\n먼지 이미지를 받아온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo docker pull jenkins/jenkins</code></pre></div>\n<p>만약 <code class=\"language-text\">Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</code>와같은 에러가 발생한다면 docker service가 stop 상태이므로 아래의 명령어로 작동시켜준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo service docker stop\nsudo service docker start</code></pre></div>\n<p>실패를 했다면 다시 이미지를 받아온 후 이미지가 잘 받아졌나 확인해보자</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo docker images</code></pre></div>\n<p>이미지로 컨테이너를 띄워보자</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo docker run -d -p 9000:8080 -v /jenkins:/var/jenkins_home --name jenkins -u root jenkins/jenkins\n\n# 옵션 설명\n# -d: 백그라운드 실행\n# -p: 포트옵션(외부포트번호:내부포트번호\u001d)\n# -v: 호스트와 볼륨 공유(호스트경로:컨테이너내부경로)\n# --name: 컨테이너 이름 설정\n\n# 컨테이너 확인\nsudo docker ps -a</code></pre></div>\n<p>젠킨스가 잘 설치되었다. 한번 접속해보자. 우리는 9000포트에 연결해줬으므로 9000포트로 접속하자</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ip주소:9000</code></pre></div>\n<p>비밀번호를 입력하라고 뜬다. 컨테이너로 설치한 경우에는 컨테이너의 로그를 확인하면 비밀번호를 알 수 있다. 그렇지 않은 경우에는 <code class=\"language-text\">/var/jenkins_home/secrets/initialAdminPassword</code>를 관리자 권한으로 열면 비밀번호가 들어있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 컨테이너 목록에서 id 확인(첫번째 열)\nsudo docer ps -a\n\n# 로그 확인\nsudo logs {컨테이너 id}</code></pre></div>\n<p>허나 필자의 경우 로그에서 비밀번호를 확인할 수 없었다(없는건지 못찾는건지... ) 이럴경우 컨테이너에 위치한 초기비밀번호에 직접 접근해서 확인하자</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo docker exec {컨테이너 id} cat /var/jenkins_home/secrets/initialAdminPassword</code></pre></div>\n<p>위 명령어를 입력하면 초기 비밀번호가 출력될 것이다.\n초기비밀번호를 입력하고 젠킨스에 접속하자.</p>\n<p>일반적으로는 처음에 플러그인 설치하는 화면이 나오는데 필자는 나오지 않아 직접 설치했다...</p>\n<p>하나씩 진행하면서 필요한 플러그인들을 함께 설치해나가자..\n플러그인을 설치하는 방법은 젠킨스 관리 > 플러그인 관리에서 검색을 통해 설치할 수 있다</p>","title":"[나와 초대장] 도커로 무중단 자동배포 ","date":"2020-08-24 09:00:00 +0900"}}}